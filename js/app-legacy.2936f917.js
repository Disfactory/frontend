(function(){"use strict";var t={83614:function(t,e,a){a(23792),a(3362),a(69085),a(9391);var o,n=a(85471),i=a(21482),r=a(48929),s=a(32696),l=a(88024),c=a(44341),u=a(52938),p=a(19925),d=a(56179),m=a(14400),f=a(90004),v=a(46268),y=a(765),g=a(18841),h=a(54376),_=a(41034),A=a(92367),w=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(i.A,[e(r.A,{directives:[{name:"show",rawName:"v-show",value:t.appState.isInitialState||t.appState.isEditFactoryMode&&t.$vuetify.breakpoint.mdAndUp,expression:"appState.isInitialState || (appState.isEditFactoryMode && $vuetify.breakpoint.mdAndUp)"}],attrs:{app:"",color:"primary",dark:"","clipped-right":""}},[e(l.A,{staticClass:"d-sm-none",staticStyle:{visibility:"hidden"},attrs:{icon:""}},[e(d.A,[t._v("mdi-temp")])],1),e(_.A,{staticClass:"d-sm-none"}),e(A.sw,[t._v("農地工廠回報")]),e(_.A),e("div",{staticClass:"d-none d-sm-flex"},[e(l.A,{attrs:{text:""},on:{click:t.modalActions.openTutorialModal}},[t._v(" 使用教學 ")]),e(l.A,{attrs:{text:""},on:{click:t.modalActions.openSafetyModal}},[t._v(" 安全須知 ")]),e(l.A,{attrs:{text:""},on:{click:t.modalActions.openContactModal}},[t._v(" 聯絡我們 ")]),e(l.A,{attrs:{text:"",href:"https://about.disfactory.tw/#question"}},[t._v(" 常見問題 ")]),e(l.A,{attrs:{text:"",href:"https://about.disfactory.tw",target:"_blank"}},[t._v(" 關於回報系統 ")]),e(l.A,{attrs:{text:"",href:"https://airtable.com/shrUraKakZRpH52DO",target:"_blank"}},[t._v(" 問題回報 ")])],1),e(s.A,{staticClass:"d-flex d-sm-none",on:{click:function(e){t.drawer=!t.drawer}}})],1),e(h.A,{staticClass:"app-sidebar",attrs:{app:"",right:"",temporary:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[e(m.A,{attrs:{nav:"",dense:""}},[e(v.A,{attrs:{"active-class":"deep-purple--text text--accent-4"}},[e(f.A,{on:{click:t.modalActions.openTutorialModal}},[e(y.UZ,[t._v("使用教學")])],1),e(f.A,{on:{click:t.modalActions.openSafetyModal}},[e(y.UZ,[t._v("安全須知")])],1),e(f.A,{on:{click:t.modalActions.openContactModal}},[e(y.UZ,[t._v("聯絡我們")])],1),e(f.A,{attrs:{href:"https://about.disfactory.tw/#section-f_c360c8de-447e-4c0a-a856-4af18b9a5240",target:"_blank"}},[e(y.UZ)],1),e(f.A,{attrs:{href:"https://about.disfactory.tw",target:"_blank"}},[e(y.UZ,[t._v("關於回報系統")])],1),e(f.A,{attrs:{href:"https://airtable.com/shrUraKakZRpH52DO",target:"_blank"}},[e(y.UZ,[t._v("問題回報")])],1)],1)],1)],1),e(g.A,{staticStyle:{"max-height":"100%",height:"100%"}},[e("app-alert",{attrs:{alert:t.alertState.alert,dismiss:t.alertActions.dismissAlert}}),e(p.A,{attrs:{"max-width":"305"},model:{value:t.modalState.createFactorySuccessModal,callback:function(e){t.$set(t.modalState,"createFactorySuccessModal",e)},expression:"modalState.createFactorySuccessModal"}},[e(c.A,{staticClass:"text-center pt-5"},[e(d.A,{staticStyle:{"font-size":"80px"},attrs:{color:"primary"}},[t._v(" mdi-checkbox-marked-circle ")]),e(u.ri,{staticClass:"secondary--text justify-center"},[t._v(" 新增可疑工廠成功 ")]),e(u.OQ,[e("small",[t._v(" 3 秒後自動關閉提示訊息 ")])])],1)],1),e(p.A,{attrs:{"max-width":"305"},model:{value:t.modalState.updateFactoryImageSuccessModal,callback:function(e){t.$set(t.modalState,"updateFactoryImageSuccessModal",e)},expression:"modalState.updateFactoryImageSuccessModal"}},[e(c.A,{staticClass:"text-center pt-5"},[e(d.A,{staticStyle:{"font-size":"80px"},attrs:{color:"primary"}},[t._v(" mdi-checkbox-marked-circle ")]),e(u.ri,{staticClass:"secondary--text justify-center"},[t._v(" 補充工廠照片成功 ")]),e(u.OQ,[e("small",[t._v(" 3 秒後自動關閉提示訊息 ")])])],1)],1),e(p.A,{attrs:{"max-width":"305"},model:{value:t.modalState.updateFactorySuccessModal,callback:function(e){t.$set(t.modalState,"updateFactorySuccessModal",e)},expression:"modalState.updateFactorySuccessModal"}},[e(c.A,{staticClass:"text-center pt-5"},[e(d.A,{staticStyle:{"font-size":"80px"},attrs:{color:"primary"}},[t._v(" mdi-checkbox-marked-circle ")]),e(u.ri,{staticClass:"secondary--text justify-center"},[t._v(" 補充工廠資訊成功 ")]),e(u.OQ,[e("small",[t._v(" 3 秒後自動關閉提示訊息 ")])])],1)],1),e("about-modal",{attrs:{open:t.modalState.aboutModalOpen,dismiss:t.modalActions.closeAboutModal}}),e("contact-modal",{attrs:{open:t.modalState.contactModalOpen,dismiss:t.modalActions.closeContactModal}}),e("getting-started-modal",{attrs:{open:t.modalState.gettingStartedModalOpen,dismiss:t.modalActions.closeGettingStartedModal}}),e("safety-modal",{model:{value:t.modalState.safetyModalOpen,callback:function(e){t.$set(t.modalState,"safetyModalOpen",e)},expression:"modalState.safetyModalOpen"}}),e("tutorial-modal",{attrs:{open:t.modalState.tutorialModalOpen,dismiss:t.modalActions.closeTutorialModal}}),e("ios-version-modal",{attrs:{open:t.modalState.supportIOSVersionModalOpen,dismiss:t.modalActions.closesupportIOSVersionModal}}),e("api-config-modal",{attrs:{open:t.modalState.apiConfigModalOpen,dismiss:t.modalActions.closeApiConfigModal}}),e("MapView",{attrs:{setFactoryLocation:t.appActions.setFactoryLocation}}),t.appState.isCreateMode?e("create-factory-steps"):t._e(),t.appState.isEditMode?e("update-factory-steps"):t._e()],1),e("factory-detail-page")],1)},x=[],b=a(47135),S=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"map-container"},[e("div",{ref:"root",staticClass:"map"}),t.appState.isInitialPage?e("div",{staticClass:"container-fluid px-1 pt-7 pb-4 filter-buttons-container",class:{desktop:t.$vuetify.breakpoint.mdAndUp,"sidebar-expanded":t.appState.factoryDetailsExpanded}},[e("display-setting-bottom-sheet"),t._l(t.filterButtonsData,(function(a){return e(l.A,{key:a.value,staticClass:"mx-2 mb-5 primary--text",class:{"inactive-filter":!t.checkActive(a.value)},attrs:{rounded:"",color:"white",name:a.text},on:{click:function(e){return t.onClickFilterButton(a.value)}}},[e(d.A,{attrs:{color:a.color}},[t._v("mdi-map-marker")]),t._v(" "+t._s(a.text)+" ")],1)}))],2):t._e(),e("div",{staticClass:"ol-fit-location ol-unselectable ol-control",attrs:{"data-label":"map-locate"},on:{click:t.zoomToGeolocation}},[t._m(0)]),t.appState.selectFactoryMode?e("div",{staticClass:"center-point"}):t._e(),t.appState.selectFactoryMode?t._e():e("div",{staticClass:"factory-button-group flex justify-center mb-5 mb-8-md"},[e(l.A,{attrs:{color:"primary",rounded:"",large:""},on:{click:t.onClickCreateFactoryButton}},[t._v(" 我想新增可疑工廠 ")])],1)])},C=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("button",{attrs:{title:"定位"}},[e("img",{attrs:{src:"/images/locate.svg",alt:"locate"}})])}],k=a(15060),F=a(47546),I=(a(28706),a(2008),a(74423),a(62062),a(2892),a(26099),a(21699),a(23500),a(15215)),M=a(20181),E=a.n(M),T=a(74618),O=a(47234),L=a(33610),D=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("span",[t.$vuetify.breakpoint.mdAndUp?e(O.A,{attrs:{"content-class":"display-setting-popover","close-on-content-click":!1,"nudge-width":200,"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e(l.A,t._g(t._b({staticClass:"mx-2 mb-5 white--text",attrs:{color:"primary"}},"v-btn",n,!1),o),[t._v(" 顯示設定 ")])]}}],null,!1,3665771213),model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[e(c.A,[e(m.A,[e(f.A,[e("h2",{staticClass:"primary--text text-button"},[t._v("農地範圍 •")]),e(l.A,{staticClass:"primary--text",class:t.isLUIMapVisable?"font-weight-light":"font-weight-bold",attrs:{text:"","x-small":""},on:{click:function(e){t.isLUIMapVisable=!1}}},[t._v("隱藏")]),e(l.A,{staticClass:"primary--text",class:t.isLUIMapVisable?"font-weight-bold":"font-weight-light",attrs:{text:"","x-small":""},on:{click:function(e){t.isLUIMapVisable=!0}}},[t._v("顯示")])],1),e(f.A,[e("switch-map-mode-button",{attrs:{isInSheet:!0}})],1)],1)],1)],1):e(T.A,{scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e(l.A,t._g(t._b({staticClass:"mx-2 mb-5 white--text",attrs:{color:"primary"}},"v-btn",n,!1),o),[t._v(" 顯示設定 ")])]}}]),model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[e(m.A,[e(L.A,[t._v("地圖顯示設定")]),e(f.A,[e("h2",{staticClass:"primary--text text-button"},[t._v("農地範圍 •")]),e(l.A,{staticClass:"primary--text",class:t.isLUIMapVisable?"font-weight-light":"font-weight-bold",attrs:{text:"","x-small":""},on:{click:function(e){t.isLUIMapVisable=!1}}},[t._v("隱藏")]),e(l.A,{staticClass:"primary--text",class:t.isLUIMapVisable?"font-weight-bold":"font-weight-light",attrs:{text:"","x-small":""},on:{click:function(e){t.isLUIMapVisable=!0}}},[t._v("顯示")])],1),e(f.A,[e("switch-map-mode-button",{attrs:{isInSheet:!0}})],1)],1)],1)],1)},U=[],P=(a(52675),a(89463),Symbol("MAIN_MAP_CONTROLLER")),R=(a(62010),function(){var t=this,e=t._self._c;t._self._setupProxy;return e(T.A,{scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e(l.A,t._g(t._b({staticClass:"primary--text",class:t.isInSheet?"pa-0":null,attrs:{rounded:!t.isInSheet,text:t.isInSheet,color:"white"}},"v-btn",n,!1),o),[t._v(" 切換地圖模式 • "+t._s(t.currentMapModeName)+" ")])]}}]),model:{value:t.mapModeBottomSheet,callback:function(e){t.mapModeBottomSheet=e},expression:"mapModeBottomSheet"}},[e(m.A,[e(L.A,[t._v("切換地圖模式")]),t._l(t.mapModes,(function(a){return e(f.A,{key:a.type,on:{click:function(e){t.currentMapMode=a.type}}},[e(y.UZ,{staticClass:"primary--text"},[t._v(t._s(a.name))])],1)}))],2)],1)}),z=[],B=(a(50113),a(77552)),G=a(36654),V=a(32362),j=(a(16280),a(44114),a(36033),a(40150),a(5506),a(38781),a(47764),a(62953),a(22772)),N=a(68436),W=a(47884),K=a(48069),H=a(86445),$=a(2671),Y=a(36763),Z=a(75370),Q=a(14477),J=a(82475),q=a(51117),X=a(56928),tt=a(43618),et=a(98108),at=a(85752),ot=a(18762),nt=a(35612),it=a(71286),rt=a(9464),st=a(29361),lt=a(92025),ct=a(88116),ut=a(833),pt=a(12661),dt=a(88568),mt=a(91149),ft=a(93474),vt=[{value:"2-1",text:"金屬: 沖床、銑床、車床、鏜孔"},{value:"2-2",text:"金屬: 焊接、鑄造、熱處理"},{value:"2-3",text:"金屬: 金屬表面處理、噴漆"},{value:"3",text:"塑膠加工、射出"},{value:"4",text:"橡膠加工"},{value:"5",text:"非金屬礦物（石材）"},{value:"6",text:"食品"},{value:"7",text:"皮革"},{value:"8",text:"紡織"},{value:"9",text:"其他"}],yt=["default",0,1,2,3],gt=[{type:"default",name:"未處理",documentDisplayStatuses:["疑似工廠"],color:"#A22A29"},{type:0,name:"處理中",documentDisplayStatuses:["已檢舉","已排程稽查","陳述意見期","已勒令停工"],color:"#457287"},{type:1,name:"已斷電",documentDisplayStatuses:["已發函斷電","已排程拆除"],color:"#364516"},{type:2,name:"已拆除",documentDisplayStatuses:["已拆除"],color:"#A1A1A1"},{type:3,name:"無法處理",documentDisplayStatuses:["等待新事證"],color:"#E0E0E0"}],ht=gt.reduce((function(t,e){return Object.assign(Object.assign({},t),(0,V.A)({},e.type,e))}),{}),_t=function(t){return ht[t].name},At=function(t){return ht[t].color},wt=(a(23418),a(34782),window.OffscreenCanvas?new OffscreenCanvas(500,500):document.createElement("canvas")),xt=wt.getContext("2d"),bt=function(t){return function(e){return new Promise((function(a){var o=new Image;o.crossOrigin="",o.src=e,o.style.display="none",o.onload=function(){return(0,I.sH)(void 0,void 0,void 0,(0,F.A)().mark((function e(){var n,i,r,s;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return wt.width=o.width,wt.height=o.height,xt.clearRect(0,0,wt.width,wt.height),xt.drawImage(o,0,0),n=xt.getImageData(0,0,o.width,o.height),i=n.data,e.next=8,Promise.resolve(t(i));case 8:r=document.createElement("canvas"),s=r.getContext("2d"),r.width=o.width,r.height=o.height,s.putImageData(n,0,0),a(r.toDataURL()),o.remove(),r.remove();case 16:case"end":return e.stop()}}),e)})))}}))}},St=(bt((function(t){for(var e=0;e<t.length;e+=4){var a=(t[e]+t[e+1]+t[e+2])/3;t[e]=a,t[e+1]=a,t[e+2]=a}})),[[255,241,0]]),Ct=function(t,e){return!t.some((function(t,a){return e[a]!==t}))},kt=function(t){return St.some((function(e){return Ct(e,t)}))},Ft=bt((function(t){for(var e=0;e<t.length;e+=4){var a=Array.from(t.slice(e,e+3));kt(a)?(t[e]=0,t[e+1]=0,t[e+2]=0,t[e+3]=1):(t[e]=0,t[e+1]=0,t[e+2]=0,t[e+3]=255)}})),It=a(83833),Mt=a(82380),Et=a(83399),Tt=a(87694),Ot=a(72033),Lt=a(79031),Dt={version:8,name:"Light",sources:{protomaps:{type:"vector",tiles:["https://api.protomaps.com/tiles/v2/{z}/{x}/{y}.pbf"],minzoom:0,maxzoom:14,attribution:'<a href="https://protomaps.com" target="_blank">Protomaps</a> © <a href="https://www.openstreetmap.org" target="_blank"> OpenStreetMap</a>'}},layers:[{id:"background",type:"background",paint:{"background-color":"#dddddd"}},{id:"earth",type:"fill",source:"protomaps","source-layer":"earth",paint:{"fill-color":" #e7f1ee"}},{id:"landuse_park",type:"fill",source:"protomaps","source-layer":"landuse",filter:["any",["==","pmap:kind","park"],["==","landuse","cemetery"]],paint:{"fill-color":"#c2f7d1"}},{id:"landuse_hospital",type:"fill",source:"protomaps","source-layer":"landuse",filter:["any",["==","pmap:kind","hospital"]],paint:{"fill-color":"#ffeae8"}},{id:"landuse_industrial",type:"fill",source:"protomaps","source-layer":"landuse",filter:["any",["==","pmap:kind","industrial"]],paint:{"fill-color":"#f8ffed"}},{id:"landuse_school",type:"fill",source:"protomaps","source-layer":"landuse",filter:["any",["==","pmap:kind","school"]],paint:{"fill-color":"#f2fef9"}},{id:"natural_wood",type:"fill",source:"protomaps","source-layer":"natural",filter:["any",["==","natural","wood"],["==","leisure","nature_reserve"],["==","landuse","forest"]],paint:{"fill-color":"#eafbe9"}},{id:"landuse_pedestrian",type:"fill",source:"protomaps","source-layer":"landuse",filter:["any",["==","highway","footway"]],paint:{"fill-color":"#eef0f0"}},{id:"natural_scrub",type:"fill",source:"protomaps","source-layer":"natural",filter:["in","natural","scrub","grassland"],paint:{"fill-color":"rgb(219,239,209)"}},{id:"natural_glacier",type:"fill",source:"protomaps","source-layer":"natural",filter:["==","natural","glacier"],paint:{"fill-color":"white"}},{id:"natural_sand",type:"fill",source:"protomaps","source-layer":"natural",filter:["==","natural","sand"],paint:{"fill-color":"#eff5e7"}},{id:"landuse_aerodrome",type:"fill",source:"protomaps","source-layer":"landuse",filter:["==","aeroway","aerodrome"],paint:{"fill-color":"#dbe7e7"}},{id:"transit_runway",type:"line",source:"protomaps","source-layer":"transit",filter:["has","aeroway"],paint:{"line-color":"#d1d9d9","line-width":6}},{id:"landuse_runway",type:"fill",source:"protomaps","source-layer":"landuse",filter:["any",["==","aeroway","runway"],["==","area:aeroway","runway"],["==","area:aeroway","taxiway"]],paint:{"fill-color":"#d1d9d9"}},{id:"water",type:"fill",source:"protomaps","source-layer":"water",paint:{"fill-color":"#a4cae1"}},{id:"roads_tunnels_other_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","other"]],paint:{"line-color":"#ffffff","line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,14.5,.5,20,12]}},{id:"roads_tunnels_other",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","other"]],paint:{"line-color":"#f7f7f7","line-dasharray":[1,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,14.5,.5,20,12]}},{id:"roads_tunnels_minor_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":"#e2e2e2","line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,32],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_minor",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":"#ebebeb","line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,32]}},{id:"roads_tunnels_medium_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":"#e1e1e1","line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,20,32],"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,10.5,1]}},{id:"roads_tunnels_medium",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":"#ebebeb","line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,20,32]}},{id:"roads_tunnels_major_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":"#e3cfd3","line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,19,32],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_tunnels_major",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":"#ebebeb","line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,19,32]}},{id:"roads_tunnels_highway_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","highway"]],paint:{"line-color":"#ebcea2","line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,32],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1]}},{id:"roads_tunnels_highway",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","highway"]],paint:{"line-color":"#ebebeb","line-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,32]}},{id:"physical_line_waterway",type:"line",source:"protomaps","source-layer":"physical_line",filter:["==",["get","pmap:kind"],"waterway"],paint:{"line-color":"#a4cae1","line-width":.5}},{id:"buildings",type:"fill-extrusion",source:"protomaps","source-layer":"buildings",paint:{"fill-extrusion-color":"#cbcece","fill-extrusion-height":["to-number",["get","height"]],"fill-extrusion-opacity":.5}},{id:"roads_other",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","other"]],paint:{"line-color":"#ffffff","line-dasharray":[2,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,14.5,.5,20,12]}},{id:"roads_minor_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":"#e2e2e2","line-gap-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,32],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_minor",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":"white","line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,32]}},{id:"roads_medium_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":"#e1e1e1","line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,20,32],"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,10.5,1]}},{id:"roads_medium",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":"#ffffff","line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,20,32]}},{id:"roads_major_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":"#e3cfd3","line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,19,32],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_major",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":"#ffffff","line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,19,32]}},{id:"roads_highway_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","highway"]],paint:{"line-color":"#ebcea2","line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,32],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1]}},{id:"roads_highway",type:"line",source:"protomaps","source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","highway"]],paint:{"line-color":"#fefffc","line-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,32]}},{id:"transit_railway",type:"line",source:"protomaps","source-layer":"transit",filter:["all",["==","pmap:kind","railway"]],paint:{"line-color":"#b3bcc9","line-width":2}},{id:"transit_railway_tracks",type:"line",source:"protomaps","source-layer":"transit",filter:["all",["==","pmap:kind","railway"]],paint:{"line-color":"#ffffff","line-width":.8,"line-dasharray":[6,10]}},{id:"boundaries",type:"line",source:"protomaps","source-layer":"boundaries",paint:{"line-color":"#5c4a6b","line-width":.5,"line-dasharray":[3,2]}},{id:"physical_line_waterway_label",type:"symbol",source:"protomaps","source-layer":"physical_line",minzoom:14,layout:{"symbol-placement":"line","text-font":["Microsoft JhengHei","STHeitiTC-Medium"],"text-field":["get","name"],"text-size":14,"text-letter-spacing":.3},paint:{"text-color":"white","text-halo-color":"#a4cae1","text-halo-width":2}},{id:"roads_bridges_other_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","other"]],paint:{"line-color":"#ffffff","line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,14.5,.5,20,12]}},{id:"roads_bridges_other",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","other"]],paint:{"line-color":"#ffffff","line-dasharray":[2,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,14.5,.5,20,12]}},{id:"roads_bridges_minor_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":"#e2e2e2","line-gap-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,32],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_bridges_minor",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":"white","line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,32]}},{id:"roads_bridges_medium_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":"#e1e1e1","line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,20,32],"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,10.5,1]}},{id:"roads_bridges_medium",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":"#ffffff","line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,20,32]}},{id:"roads_bridges_major_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":"#e3cfd3","line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,19,32],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_bridges_major",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":"#ffffff","line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,19,32]}},{id:"roads_bridges_highway_casing",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","highway"]],paint:{"line-color":"#ebcea2","line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,32],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1]}},{id:"roads_bridges_highway",type:"line",source:"protomaps","source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","highway"]],paint:{"line-color":"#fefffc","line-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,32]}},{id:"roads_labels",type:"symbol",source:"protomaps","source-layer":"roads",minzoom:13,layout:{"symbol-placement":"line","text-font":["Microsoft JhengHei","STHeitiTC-Medium"],"text-field":["get","name"],"text-size":14},paint:{"text-color":"#91888b","text-halo-color":"white","text-halo-width":2}},{id:"mask",type:"fill",source:"protomaps","source-layer":"mask",paint:{"fill-color":"#dddddd"}},{id:"physical_point_ocean",type:"symbol",source:"protomaps","source-layer":"physical_point",filter:["any",["==","place","sea"],["==","place","ocean"]],layout:{"text-font":["Microsoft JhengHei","STHeitiTC-Medium"],"text-field":["get","name"],"text-size":14,"text-letter-spacing":.15},paint:{"text-color":"white","text-halo-color":"#a4cae1","text-halo-width":1}},{id:"physical_point_peak",type:"symbol",source:"protomaps","source-layer":"physical_point",filter:["any",["==","natural","peak"]],layout:{"text-font":["Microsoft JhengHei","STHeitiTC-Medium"],"text-field":["get","name"],"text-size":14},paint:{"text-color":"#61bb5b","text-halo-color":"#ffffff","text-halo-width":1.5}},{id:"places_subplace",type:"symbol",source:"protomaps","source-layer":"places",filter:["==","pmap:kind","neighbourhood"],minzoom:10,layout:{"text-field":"{name}","text-font":["Microsoft JhengHei","STHeitiTC-Medium"],"text-size":{base:1.2,stops:[[11,13],[14,15]]},"text-transform":"uppercase"},paint:{"text-color":"#757d91","text-halo-color":"white","text-halo-width":1}},{id:"places_city_circle",type:"circle",source:"protomaps","source-layer":"places",filter:["==","pmap:kind","city"],paint:{"circle-radius":2,"circle-stroke-width":2,"circle-stroke-color":"white","circle-color":"#666666"},maxzoom:8},{id:"places_city",type:"symbol",source:"protomaps","source-layer":"places",filter:["==","pmap:kind","city"],layout:{"text-field":"{name}","text-font":["Microsoft JhengHei","STHeitiTC-Medium"],"text-size":["step",["get","pmap:rank"],0,1,18,2,16],"text-variable-anchor":["bottom-left"],"text-radial-offset":.2},paint:{"text-color":"#787878","text-halo-color":"white","text-halo-width":1}},{id:"places_state",type:"symbol",source:"protomaps","source-layer":"places",filter:["==","pmap:kind","state"],layout:{"text-field":"{name}","text-font":["Microsoft JhengHei","STHeitiTC-Medium"],"text-size":12,"text-radial-offset":.2,"text-anchor":"center","text-transform":"uppercase"},paint:{"text-color":"#bdbdbd","text-halo-color":"white","text-halo-width":.5}},{id:"places_country",type:"symbol",source:"protomaps","source-layer":"places",filter:["==","place","country"],layout:{"text-field":"{name}","text-font":["Microsoft JhengHei","STHeitiTC-Medium"],"text-size":{base:1.2,stops:[[2,14],[6,14],[8,20]]},"text-transform":"uppercase"},paint:{"text-color":"#9590aa","text-halo-color":"white","text-halo-width":1}}]},Ut=new Map,Pt=function(){function t(){(0,B.A)(this,t)}return(0,G.A)(t,null,[{key:"getFactoryCacheKey",value:function(t){return"".concat(t.lat,",").concat(t.lng)}},{key:"getFactoryCache",value:function(t){return Ut.get(this.getFactoryCacheKey(t))}},{key:"setFactoryCache",value:function(t,e){Ut.set(this.getFactoryCacheKey(t),e)}}])}(),Rt=Pt,zt=function(t){return"/images/marker-".concat(t,".svg")},Bt=function(t){var e;return null===(e=gt.find((function(e){return e.type==t})))||void 0===e?void 0:e.color};function Gt(t){var e;return t.wont_fix?gt[4].type:t.document_display_status?null===(e=gt.find((function(e){return e.documentDisplayStatuses.includes(t.document_display_status)})))||void 0===e?void 0:e.type:gt[0].type}(function(t){t[t["OSM"]=0]="OSM",t[t["TAIWAN"]=1]="TAIWAN",t[t["SATELITE"]=2]="SATELITE",t[t["PROTOMAP"]=3]="PROTOMAP"})(o||(o={}));var Vt=(0,V.A)((0,V.A)((0,V.A)((0,V.A)({},o.OSM,"簡易地圖"),o.TAIWAN,"詳細地圖"),o.SATELITE,"衛星地圖"),o.PROTOMAP,"向量地圖"),jt=function(){return Object.entries({zoomIn:"/images/zoom-in.svg",zoomOut:"/images/zoom-out.svg"}).reduce((function(t,e){var a=(0,b.A)(e,2),o=a[0],n=a[1],i=document.createElement("img");return i.setAttribute("src",n),i.setAttribute("alt","zoomIn"===o?"放大":"縮小"),Object.assign(Object.assign({},t),(0,V.A)({},o,i))}),{})},Nt=yt.reduce((function(t,e){return Object.assign(Object.assign({},t),(0,V.A)({},e,new K.Ay({image:new H.A({anchorYUnits:J.A.PIXELS,anchorOrigin:It.A.BOTTOM_LEFT,src:zt(e)}),zIndex:yt.indexOf(e)})))}),{}),Wt=new K.Ay({}),Kt=new K.Ay({image:new $.A({fill:new Y.A({color:"#A22929"}),radius:12,stroke:new Z.A({color:"#FFFFFF",width:1})})}),Ht=new Map,$t=function(){function t(e){(0,B.A)(this,t),this.appliedFilters=yt,this.factoryMap=new Map,this._map=e,this._factoriesLayerStatusMap={}}return(0,G.A)(t,[{key:"mapInstance",get:function(){return this._map}},{key:"factories",get:function(){return(0,k.A)(this.factoryMap.values())}},{key:"getFactoriesLayerForStatus",value:function(t){var e=this,a=50;if(!this._factoriesLayerStatusMap["".concat(t)]){this._factoriesLayerStatusMap["".concat(t)]=new it.A({features:[]});var o=new rt.A({distance:a,source:this._factoriesLayerStatusMap["".concat(t)]}),n={},i=new ot.A({source:o,zIndex:3,style:function(i,r){var s=e.mapInstance.map.getView().getZoom(),l=o.getDistance();s>16?0!==l&&o.setDistance(0):l!==a&&o.setDistance(a);var c=i.get("features");if(c.length>1){var u=c.length,p=n[u];return p||(p=new K.Ay({image:new $.A({radius:20,stroke:new Z.A({color:"#fff"}),fill:new Y.A({color:Bt(t)})}),text:new Q.A({text:u.toString(),fill:new Y.A({color:"#fff"}),scale:1.8})}),n[u]=p),p}var d=c[0];return i.set("factoryId",d.get("factoryId")),d.getStyle()}});i.setProperties({factoryStatus:t}),this.mapInstance.map.addLayer(i)}return this._factoriesLayerStatusMap["".concat(t)]}},{key:"getFactory",value:function(t){return this.factoryMap.get(t)}},{key:"updateFactory",value:function(t,e){this.factoryMap.set(t,e);var a=this.getFactoriesLayerForStatus(Gt(e)).getFeatureById(t);if(a){var o=this.getFactoryStyle(e);Ht.set(t,o.clone()),a.setStyle(o)}}},{key:"addFactories",value:function(t){var e=this,a=this.createFactoryFeature.bind(this),o=[],n=[];t.forEach((function(t){e.factoryMap.has(t.id)?n.push(t):o.push(t)}));var i=o.map(a).filter(Boolean),r={};i.forEach((function(t){r[t.get("factoryStatus")]||(r[t.get("factoryStatus")]=[]),r[t.get("factoryStatus")].push(t)})),Object.entries(r).forEach((function(t){var a=(0,b.A)(t,2),o=a[0],n=a[1];e.getFactoriesLayerForStatus(o).addFeatures(n)}))}},{key:"hideFactories",value:function(t){var e=this;t.forEach((function(t){var a=e.getFactoriesLayerForStatus(Gt(t)).getFeatureById(t.id);a.setStyle(Wt)}))}},{key:"setFactoryStatusFilter",value:function(t){this.appliedFilters=t,this.updateFactoriesFeatureStyle()}},{key:"isFactoryVisible",value:function(t){return this.appliedFilters.includes(Gt(t))}},{key:"getFactoryStyle",value:function(t){var e=this.isFactoryVisible(t);return e?Nt[Gt(t)]:Wt}},{key:"createFactoryFeature",value:function(t){var e=Rt.getFactoryCache(t);if(e)return null;var a=new j.A({geometry:new q.A((0,et.pd)([t.lng,t.lat],"EPSG:4326","EPSG:3857"))});a.setId(t.id),a.set("factoryId",t.id),a.set("factoryStatus",Gt(t));var o=this.getFactoryStyle(t);return Ht.set(t.id,o.clone()),a.setStyle(o),this.factoryMap.set(t.id,t),Rt.setFactoryCache(t,a),a}},{key:"forEachFeatureFactory",value:function(t){var e=this;Object.entries(this._factoriesLayerStatusMap).forEach((function(a){var o=(0,b.A)(a,2),n=o[1];n.getFeatures().forEach((function(a){var o=a.getId(),n=e.factoryMap.get(o);t(a,n)}))}))}},{key:"displayAllFactory",value:function(){this.forEachFeatureFactory((function(t,e){t.setStyle(Nt[Gt(e)])}))}},{key:"updateFactoriesFeatureStyle",value:function(){var t=this;this.forEachFeatureFactory((function(e,a){e.setStyle(t.getFactoryStyle(a))}))}}])}(),Yt=function(){for(var t=(0,et.Jt)("EPSG:3857"),e=t.getExtent(),a=new Array(21),o=(0,at.RG)(e)/256,n=new Array(21),i=0;i<21;++i)a[i]=o/Math.pow(2,i),n[i]=i;return new tt.A({origin:(0,at.Py)(e),resolutions:a,matrixIds:n})},Zt=function(t,e){if(t===o.PROTOMAP){var a=(0,et.DI)([119.90423060095736,21.83090666506977,122.2876172488333,25.33409668479448],"EPSG:4326","EPSG:3857"),n=new Mt.A({source:new Et.A({attributions:'<a href="https://protomaps.com" target="_blank">Protomaps</a> © <a href="https://www.openstreetmap.org" target="_blank"> OpenStreetMap</a>',format:new Tt.A,url:{VUE_APP_PROTOMAP_API_KEY:"e6cfbd46818cf623",NODE_ENV:"production",VUE_APP_BASE_URL:"https://staging.disfactory.tw/api",VUE_APP_IMGUR_FALLBACK_URL:"https://staging.disfactory.tw/imgur",VUE_APP_IMAGE_UPLOAD_PROVIDER:"backend",VUE_APP_IMAGE_UPLOAD_URL:"https://staging.disfactory.tw/api/upload",BASE_URL:"/"}.VUE_APP_PROTOMAP_SOURCE_URL||"https://api.disfactory.tw/tiles/{z}/{x}/{y}.pbf",maxZoom:14}),opacity:1,zIndex:1,renderMode:Ot.A.VECTOR});return n.setExtent(a),(0,Lt.Ay)(n,Dt,"protomaps"),n}var i=function(){switch(t){case o.OSM:return new st.A({crossOrigin:"Anonymous",attributions:'<a href="https://osm.tw/" target="_blank">OpenStreetMap 台灣</a>'});case o.TAIWAN:return new X.A({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts",layer:"EMAP",tileGrid:e,crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'});case o.SATELITE:return new X.A({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/PHOTO_MIX/default/EPSG:3857/{TileMatrix}/{TileRow}/{TileCol}",layer:"EMAP",tileGrid:e,requestEncoding:"REST",crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'});default:return new st.A({crossOrigin:"Anonymous",attributions:'<a href="https://osm.tw/" target="_blank">OpenStreetMap 台灣</a>'})}}();return new nt.A({source:i,opacity:.6,zIndex:1})},Qt=function(t){return new nt.A({source:new X.A({matrixSet:"EPSG:3857",format:"image/png",url:"https://wmts.nlsc.gov.tw/wmts/nURBAN2/default/EPSG:3857/{TileMatrix}/{TileRow}/{TileCol}",layer:"LUIMAP",requestEncoding:"REST",tileGrid:t,tileLoadFunction:function(t,e){var a=t.getImage();Ft(e).then((function(t){a.src=t}))},crossOrigin:"Anonymous",style:"default",wrapX:!0,attributions:'<a href="https://maps.nlsc.gov.tw/" target="_blank">國土測繪圖資服務雲</a>'}),opacity:.5,zIndex:2,className:"lui-layer"})},Jt=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,B.A)(this,t),this.tileGrid=Yt(),this.hasInitialLocation=!1,this.mapDom=e,this.baseLayer=Zt(o.OSM,this.tileGrid),this._map=this.instantiateOLMap(this.mapDom,this.baseLayer,n),n.minimap||(this.geolocation=this.setupGeolocationTracking(this._map)),this.setupEventListeners(this._map,a)}return(0,G.A)(t,[{key:"map",get:function(){return this._map}},{key:"setupEventListeners",value:function(t,e){var a=this,o=function(){return(0,I.sH)(a,void 0,void 0,(0,F.A)().mark((function a(){var o,n,i,r,s,l,c,u,p,d,m,f;return(0,F.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o=t.getView(),n=o.getZoom(),i=o.getResolutionForZoom(n),r=Math.ceil(i/2),s=(0,et.pd)(o.getCenter(),"EPSG:3857","EPSG:4326"),l=(0,b.A)(s,2),c=l[0],u=l[1],!e.onMoved){a.next=11;break}return p=this.mapDom.getBoundingClientRect(),d=p.width,m=p.height,a.next=9,this.canPlaceFactory([d/2,m/2]);case 9:f=a.sent,e.onMoved([c,u,r,n],f);case 11:case"end":return a.stop()}}),a,this)})))};t.on("change:resolution",o),t.on("moveend",o),t.on("rendercomplete",o),t.on("zoomend",(function(){var a=t.getView(),o=a.getZoom();e.onZoomed&&e.onZoomed(o)})),t.on("click",(function(o){return(0,I.sH)(a,void 0,void 0,(0,F.A)().mark((function a(){var n,i,r,s,l;return(0,F.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.onClicked&&(n=(0,et.pd)(o.coordinate,"EPSG:3857","EPSG:4326"),i=(0,b.A)(n,2),r=i[0],s=i[1],l=t.forEachFeatureAtPixel(o.pixel,(function(t){return t}),{layerFilter:function(t){return 5!==t.getZIndex()}}),e.onClicked([r,s],l));case 1:case"end":return a.stop()}}),a)})))})),t.on("pointermove",(function(e){e.dragging||(t.getTargetElement().style.cursor=t.hasFeatureAtPixel(t.getEventPixel(e.originalEvent))?"pointer":"")}));var n=this.getLUIMAPLayer();n.on("change:visible",(function(){e.onLUILayerVisibilityChange&&e.onLUILayerVisibilityChange(n.getVisible())}))}},{key:"setCoordinate",value:function(t,e,a){var o=this.map.getView();a=a||o.getZoom(),o.setCenter((0,et.pd)([t,e],"EPSG:4326","EPSG:3857")),o.setZoom(a)}},{key:"instantiateOLMap",value:function(t,e){var a,o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Yt();if(n.getInitialLocation&&(o=n.getInitialLocation())){var r=o,s=(0,b.A)(r,3),l=s[0],c=s[1],u=s[2];a=new N.Ay({center:(0,et.pd)([l,c],"EPSG:4326","EPSG:3857"),zoom:u}),this.hasInitialLocation=!0}else a=new N.Ay({center:(0,et.pd)([120.48504632216294,24.088258816482295],"EPSG:4326","EPSG:3857"),zoom:14});var p=jt(),d={target:t,layers:[e,Qt(i)],view:a,controls:[new lt.A({zoomInLabel:p.zoomIn,zoomOutLabel:p.zoomOut,zoomInTipLabel:"放大",zoomOutTipLabel:"縮小"}),new ct.A,new ut.A,new pt.A],interactions:(0,mt.NT)({pinchRotate:!1}).extend([new ft.A({threshold:.4})])};return n.minimap&&(d.controls=[],d.interactions=[]),new W.A(d)}},{key:"setupGeolocationTracking",value:function(t){var e=t.getView(),a=new dt.A({trackingOptions:{enableHighAccuracy:!0},projection:e.getProjection()});a.setTracking(!0);var o=this.setupGeolocationLayer(a);return t.addLayer(o),a}},{key:"setupGeolocationLayer",value:function(t){var e=this,a=new j.A,o=function(t){return Number.isNaN(t)?new K.Ay({image:new $.A({fill:new Y.A({color:"#0099ff"}),stroke:new Z.A({color:"#fff",width:3}),radius:15})}):new K.Ay({image:new H.A({anchor:[.5,.5],src:"/images/now.svg",rotation:t,rotateWithView:!0})})};a.setStyle(o(NaN)),t.on("change:position",(function(){var e=t.getPosition();a.setGeometry(e?new q.A(e):void 0)})),t.on("change:heading",(function(){var e;a.setStyle(o(null!==(e=t.getHeading())&&void 0!==e?e:NaN))}));var n=new j.A;t.on("change:accuracyGeometry",(function(){n.setGeometry(t.getAccuracyGeometry())}));var i=this.hasInitialLocation;t.on("change",(function(){if(!i){var a=t.getPosition();a&&(e.zoomToGeolocation(),i=!0)}}));var r=new ot.A({source:new it.A({features:[a,n]}),zIndex:5});return r}},{key:"zoomToGeolocation",value:function(){if(!this.geolocation)throw new Error("No location permission");var t=this.geolocation.getPosition();if(!t)throw new Error("No location permission");var e=this._map.getView();e.setCenter(t),e.setZoom(16)}},{key:"changeBaseMap",value:function(t){this._map.removeLayer(this.baseLayer),this.baseLayer=Zt(t,this.tileGrid),this._map.addLayer(this.baseLayer)}},{key:"canPlaceFactory",value:function(t){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function e(){var a=this;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var o=!1,n=a._map.forEachLayerAtPixel(t,(function(t,a){var n=(0,b.A)(a,4),i=n[3];o=!0,e(128!==i)}),{layerFilter:function(t){return"lui-layer"===t.getClassName()}});o||e(void 0===n||n)})));case 1:case"end":return e.stop()}}),e)})))}},{key:"getLUIMAPLayer",value:function(){var t;if(this._map.getLayers().forEach((function(e){"LUIMAP"===e.getProperties().source.layer_&&(t=e)})),!t)throw new TypeError("LUIMAP Layer not found");return t}},{key:"setLUILayerVisible",value:function(t){var e=this.getLUIMAPLayer();e.setVisible(t)}},{key:"getLUILayerVisible",value:function(){var t=this.getLUIMAPLayer();return t.getVisible()}},{key:"setMinimapPin",value:function(t,e){var a=(0,et.pd)([t,e],"EPSG:4326","EPSG:3857");if(this.minimapPinFeature)this.minimapPinFeature.setGeometry(new q.A(a));else{var o=new j.A({geometry:new q.A(a)});o.setStyle(Kt),this.minimapPinFeature=o;var n=new it.A({features:[o]}),i=new ot.A({source:n,zIndex:4});this.map.addLayer(i)}this._map.getView().setCenter(a)}}])}();function qt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,o=new Jt(t,e,a);return window.changeBaseMap=o.changeBaseMap.bind(o),new $t(o)}function Xt(t,e){var a=new Jt(t,{},{minimap:!0});return a.map.getView().setCenter(e),new $t(a)}var te=Symbol("MapModeSymbol");function ee(){var t=(0,n.WQ)(te);if(!t)throw new Error("Please use provideMapMode before useMapMode.");return t}var ae=(0,n.pM)({name:"SwitchMapModeButton",props:{isInSheet:{type:Boolean,default:!1}},setup:function(){var t=(0,n.KR)(!1),e=(0,n.WQ)(P,(0,n.KR)()),a=ee(),i=a.currentMapMode,r=(0,n.EW)({get:function(){return i.value},set:function(a){var o;i.value=a,null===(o=e.value)||void 0===o||o.mapInstance.changeBaseMap(a),t.value=!1}}),s=[o.SATELITE,o.OSM,o.TAIWAN,o.PROTOMAP].map((function(t){return{type:t,name:Vt[t]}})),l=(0,n.EW)((function(){var t,e,a;return null!==(e=null===(t=s.find((function(t){return t.type===r.value})))||void 0===t?void 0:t.name)&&void 0!==e?e:null===(a=s[0])||void 0===a?void 0:a.name}));return{mapModeBottomSheet:t,mapModes:s,currentMapMode:r,currentMapModeName:l}}}),oe=ae,ne=a(845),ie=(0,ne.A)(oe,R,z,!1,null,null,null),re=ie.exports,se=(0,n.pM)({name:"DisplaySettingBottomSheet",components:{SwitchMapModeButton:re},setup:function(){var t=(0,n.KR)(!1),e=(0,n.WQ)(P,(0,n.KR)()),a=(0,n.KR)(!1),o=(0,n.EW)({get:function(){var t;return!!(null===(t=e.value)||void 0===t?void 0:t.mapInstance.getLUILayerVisible())},set:function(t){var o;null===(o=e.value)||void 0===o||o.mapInstance.setLUILayerVisible(t),a.value=t}});return{isOpen:t,isLUIMapVisable:o}}}),le=se,ce=(0,ne.A)(le,D,U,!1,null,"2c80a36f",null),ue=ce.exports,pe=(a(33110),a(50778),a(3296),a(27208),a(48408),a(14603),a(47566),a(98721),a(72505)),de=a.n(pe),me=a(68308),fe=a.n(me),ve="api-base-url",ye="https://staging.disfactory.tw/api",ge=(0,n.KR)(localStorage.getItem(ve)),he=(0,n.EW)((function(){return ge.value||ye})),_e=function(){return ye},Ae=function(t){ge.value=t,localStorage.setItem(ve,t)},we=function(){ge.value=null,localStorage.removeItem(ve)},xe=function(){return ge.value},be=de().create({headers:{"Content-Type":"application/json"}}),Se=function(){be.defaults.baseURL=he.value};Se(),(0,n.wB)(he,Se);var Ce="backend",ke="https://staging.disfactory.tw/api/upload";function Fe(t,e,a){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function o(){var n,i;return(0,F.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,be.get("/factories?range=".concat(t,"&lng=").concat(e,"&lat=").concat(a));case 3:return n=o.sent,i=n.data,o.abrupt("return",i);case 8:throw o.prev=8,o.t0=o["catch"](0),console.error(o.t0),new TypeError("Get factory failed");case 12:case"end":return o.stop()}}),o,null,[[0,8]])})))}function Ie(t){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function e(){var a,o;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be.get("/factories/".concat(t));case 3:return a=e.sent,o=a.data,e.abrupt("return",o);case 8:throw e.prev=8,e.t0=e["catch"](0),console.error(e.t0),new TypeError("Get factory failed");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))}var Me="39048813b021935";function Ee(t){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function e(){var a,o,n;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("image",t),e.next=4,de()({method:"POST",url:"https://api.imgur.com/3/image",data:a,headers:{"Content-Type":"multipart/form-data",Authorization:"Client-ID ".concat(Me)}});case 4:return o=e.sent,n=o.data,e.abrupt("return",{link:n.data.link,deletehash:n.data.deletehash,file:t});case 7:case"end":return e.stop()}}),e)})))}function Te(t){var e;return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function a(){var o,n,i,r;return(0,F.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=new FormData,o.append("image",t),n=ke||"".concat(he.value,"/upload"),a.next=5,de()({method:"POST",url:n,data:o,headers:{"Content-Type":"multipart/form-data"}});case 5:if(i=a.sent,r=i.data,r.success){a.next=9;break}throw new Error((null===(e=r.data)||void 0===e?void 0:e.error)||"Image upload failed");case 9:return a.abrupt("return",{link:r.data.link,deletehash:r.data.deletehash,file:t});case 10:case"end":return a.stop()}}),a)})))}function Oe(t){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function e(){return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("backend"!==Ce){e.next=2;break}return e.abrupt("return",Te(t));case 2:return e.abrupt("return",Ee(t));case 3:case"end":return e.stop()}}),e)})))}var Le=function(t){return t[0]+t[1]/60+t[2]/3600};function De(t){var e=new FileReader;return new Promise((function(a){e.onload=function(t){if(t.target){var e=fe().readFromBinaryFile(t.target.result),o={};e.GPSLatitude&&(o.Latitude=Le(e.GPSLatitude)),e.GPSLongitude&&(o.Longitude=Le(e.GPSLongitude)),e.DateTimeOriginal&&(o.DateTimeOriginal=e.DateTimeOriginal),a(o)}else a({})},e.readAsArrayBuffer(t)}))}function Ue(t){var e=t.link,a=t.file,o=t.deletehash;return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function t(){var n,i,r;return(0,F.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,De(a);case 2:return n=t.sent,t.next=5,be.post("/images",Object.assign(Object.assign({url:e},n),{deletehash:o}));case 5:return i=t.sent,r=i.data,t.abrupt("return",{token:r.token,src:URL.createObjectURL(a)});case 8:case"end":return t.stop()}}),t)})))}function Pe(t){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function e(){return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(Array.from(t).map((function(t){return Oe(t).then((function(t){return Ue(t)}))}))));case 1:case"end":return e.stop()}}),e)})))}function Re(t,e,a){var o=a.nickname,n=a.contact;return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function a(){var i=this;return(0,F.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",Promise.all(Array.from(e).map((function(e){return Oe(e).then((function(e){return function(){return(0,I.sH)(i,void 0,void 0,(0,F.A)().mark((function a(){var i,r,s;return(0,F.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,De(e.file);case 2:return i=a.sent,a.next=5,be.post("/factories/".concat(t,"/images"),Object.assign(Object.assign({url:e.link},i),{nickname:o,contact:n,deletehash:e.deletehash}));case 5:return r=a.sent,s=r.data,s.image_path=e.link,a.abrupt("return",s);case 9:case"end":return a.stop()}}),a)})))}()}))}))));case 1:case"end":return a.stop()}}),a)})))}function ze(t){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function e(){var a,o;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be.post("/factories",JSON.stringify(t));case 3:return a=e.sent,o=a.data,e.abrupt("return",o);case 8:throw e.prev=8,e.t0=e["catch"](0),console.error(e.t0),new TypeError("Create factory failed");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))}function Be(t,e){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function a(){var o,n;return(0,F.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,be.put("/factories/".concat(t),JSON.stringify(e));case 3:return o=a.sent,n=o.data,a.abrupt("return",n);case 8:throw a.prev=8,a.t0=a["catch"](0),console.error(a.t0),new TypeError("Update factory failed");case 12:case"end":return a.stop()}}),a,null,[[0,8]])})))}function Ge(t){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function e(){var a,o;return(0,F.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be.get("/factories/".concat(t,"/report_records"));case 3:return a=e.sent,o=a.data,e.abrupt("return",o);case 8:throw e.prev=8,e.t0=e["catch"](0),console.error(e.t0),new TypeError("Fetch factory error");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))}var Ve=a(85378),je=a(32317);function Ne(){var t,e=(0,n.nI)(),a=null===(t=null===e||void 0===e?void 0:e.proxy)||void 0===t?void 0:t.$gtag,o=function(t){a&&a.pageview({page_path:t})},i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a&&a.event(t,e)};return{pageview:o,event:i}}a(48598),a(27495),a(90906),a(71761);var We=!(!navigator.userAgent.match(/(iPod|iPhone|iPad)/)||!navigator.userAgent.match(/AppleWebKit/));/^((?!chrome|android).)*safari/i.test(navigator.userAgent);function Ke(){if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);if(t)return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||"0",10)].join(".")}}function He(){var t;return!!We&&!!(t=Ke())&&!!t.match(/^13\.(1|2|3)/)}var $e,Ye=(0,n.Kh)({updateFactorySuccessModal:!1,updateFactoryImageSuccessModal:!1,createFactorySuccessModal:!1,aboutModalOpen:!1,contactModalOpen:!1,safetyModalOpen:!1,gettingStartedModalOpen:"true"!==localStorage.getItem("use-app"),tutorialModalOpen:!1,supportIOSVersionModalOpen:He(),apiConfigModalOpen:!1,sidebarOpen:!1,filterModalOpen:!1}),Ze=function(){var t=Ne(),e=t.event,a=function(){Ye.updateFactoryImageSuccessModal=!0,window.setTimeout((function(){Ye.updateFactoryImageSuccessModal=!1}),3e3)},o=function(){Ye.updateFactorySuccessModal=!0,window.setTimeout((function(){Ye.updateFactorySuccessModal=!1}),3e3)},n=function(){Ye.createFactorySuccessModal=!0,window.setTimeout((function(){Ye.createFactorySuccessModal=!1}),3e3)},i=function(){Ye.createFactorySuccessModal=!1},r=function(){Ye.aboutModalOpen=!0},s=function(){Ye.aboutModalOpen=!1},l=function(){Ye.contactModalOpen=!0},c=function(){Ye.contactModalOpen=!1},u=function(){Ye.safetyModalOpen=!0},p=function(){Ye.safetyModalOpen=!1},d=function(){Ye.gettingStartedModalOpen=!0},m=function(){Ye.gettingStartedModalOpen=!1},f=function(){Ye.tutorialModalOpen=!0},v=function(){Ye.tutorialModalOpen=!1},y=function(){Ye.apiConfigModalOpen=!0};window.openApiConfigModal=y;var g=function(){Ye.apiConfigModalOpen=!1},h=function(){Ye.supportIOSVersionModalOpen=!1},_=function(){var t=!Ye.sidebarOpen;e("toggleSidebar",{target:t}),Ye.sidebarOpen=t},A=function(){e("closeFilterModal"),Ye.filterModalOpen=!1},w=function(){e("openFilterModal"),Ye.filterModalOpen=!0},x={openUpdateFactorySuccessModal:o,openUpdateFactoryImagesSuccessModal:a,openCreateFactorySuccessModal:n,closeCreateFactorySuccessModal:i,openAboutModal:r,closeAboutModal:s,openContactModal:l,closeContactModal:c,openSafetyModal:u,closeSafetyModal:p,openGettingStartedModal:d,closeGettingStartedModal:m,openTutorialModal:f,closeTutorialModal:v,openApiConfigModal:y,closeApiConfigModal:g,toggleSidebar:_,openFilterModal:w,closeFilterModal:A,closesupportIOSVersionModal:h};return[Ye,x]};(function(t){t["INITIAL"]="INITIAL",t["CREATE_FACTORY_1"]="CREATE_FACTORY_1",t["CREATE_FACTORY_2"]="CREATE_FACTORY_2",t["CREATE_FACTORY_3"]="CREATE_FACTORY_3",t["UPDATE_FACTORY_IMAGES"]="UPDATE_FACTORY_IMAGES",t["UPDATE_FACTORY_MODE"]="UPDATE_FACTORY_MODE"})($e||($e={}));var Qe,Je=[$e.CREATE_FACTORY_1,$e.CREATE_FACTORY_2,$e.CREATE_FACTORY_3],qe=[$e.UPDATE_FACTORY_IMAGES,$e.UPDATE_FACTORY_MODE],Xe=(0,n.Kh)({pageState:$e.INITIAL,factoryData:null,factoryLocation:[],get isCreateMode(){return Je.includes(Xe.pageState)},get createStepIndex(){return Je.indexOf(Xe.pageState)+1},get isEditImagesMode(){return Xe.pageState===$e.UPDATE_FACTORY_IMAGES},get isEditFactoryMode(){return Xe.pageState===$e.UPDATE_FACTORY_MODE},updateFactoryField:"others",get isEditComment(){return Xe.pageState===$e.UPDATE_FACTORY_MODE&&"others"===Xe.updateFactoryField},get isEditName(){return Xe.pageState===$e.UPDATE_FACTORY_MODE&&"name"===Xe.updateFactoryField},get isEditType(){return Xe.pageState===$e.UPDATE_FACTORY_MODE&&"factory_type"===Xe.updateFactoryField},get isEditMode(){return qe.includes(Xe.pageState)},get isInitialState(){return Xe.pageState===$e.INITIAL},get selectFactoryMode(){return Xe.pageState===$e.CREATE_FACTORY_1},get formPageOpen(){return Je.includes(Xe.pageState)||Xe.pageState===$e.UPDATE_FACTORY_IMAGES},get isInitialPage(){return Xe.pageState===$e.INITIAL},mapLngLat:[],canPlaceFactory:!1,factoryDetailsExpanded:!1}),ta=function(){var t=Ne(),e=t.event,a=t.pageview,o=function(){throw new Error("Invalid page transition")},n={startCreateFactory:function(){Xe.pageState===$e.INITIAL?Xe.pageState=$e.CREATE_FACTORY_1:o(),e("enterSelectFactoryMode")},gotoNextCreate:function(){var t=Je.indexOf(Xe.pageState);-1!==t&&t!==Je.length-1?Xe.pageState=Je[t+1]:o(),0===t&&a("/create")},nextCreateStep:function(){var t=Je.indexOf(Xe.pageState);Je[t+1]&&(Xe.pageState=Je[t+1])},previousCreateStep:function(){var t=Je.indexOf(Xe.pageState);Je[t-1]&&(Xe.pageState=Je[t-1])},cancelCreateFactory:function(){Xe.pageState in Je?Xe.pageState=$e.INITIAL:o(),e("exitSelectFactoryMode")},gotoCreateStep:function(t){Je[t]?Xe.pageState=Je[t]:o()},startUpdateFactoryImages:function(){Xe.pageState===$e.INITIAL?Xe.pageState=$e.UPDATE_FACTORY_IMAGES:o(),a("/edit")},cancelUpdateFactoryImages:function(){Xe.pageState===$e.UPDATE_FACTORY_IMAGES?Xe.pageState=$e.INITIAL:o(),e("exitUpdateFactoryImagesMode")},startUpdateFactoryComment:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"others";Xe.pageState===$e.INITIAL?(Xe.pageState=$e.UPDATE_FACTORY_MODE,Xe.updateFactoryField=t):o(),a("/editComment")},cancelUpdateFactoryComment:function(){Xe.pageState===$e.UPDATE_FACTORY_MODE?Xe.pageState=$e.INITIAL:o(),e("exitUpdateFactoryCommentsMode")},closeFactoryPage:function(){Je.includes(Xe.pageState)||qe.includes(Xe.pageState)?Xe.pageState=$e.INITIAL:o(),e("closeFactoryPage")}};function i(t){Xe.factoryData=t}function r(){Xe.factoryDetailsExpanded=!0}function s(){var t,e,a,o=Ht.get(null===(t=Xe.factoryData)||void 0===t?void 0:t.id);o&&(null===(a=null===(e=Xe.factoryData)||void 0===e?void 0:e.feature)||void 0===a||a.setStyle(o)),Xe.factoryDetailsExpanded=!1,Xe.factoryData=null}function l(){Xe.factoryDetailsExpanded=!Xe.factoryDetailsExpanded}var c={pageTransition:n,updateFactoryData:i,openEditFactoryForm:function(t){i(t),n.startUpdateFactoryImages(),a("/edit")},setFactoryLocation:function(t){Xe.factoryLocation=t,e("setFactoryLocation")},expandFactoryDetail:r,collapseFactoryDetail:s,toggleFactoryDetail:l};return[Xe,c]};(function(t){t["info"]="info",t["warn"]="warn",t["error"]="error"})(Qe||(Qe={}));var ea=(0,n.Kh)({alert:null,timeout:void 0}),aa=function(){var t={showAlert:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qe.warn,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"此錯誤訊息將在3秒後消失。";ea.alert={title:t,level:a,dismissText:o},ea.timeout&&window.clearTimeout(ea.timeout),ea.timeout=window.setTimeout((function(){ea.alert=null,ea.timeout=void 0}),e)},dismissAlert:function(){ea.alert=null,ea.timeout&&(window.clearTimeout(ea.timeout),ea.timeout=void 0)}};return[ea,t]};a(9868);function oa(t){var e=/^#(.+)/.exec(t);return e?e[1].split("&").reduce((function(t,e){var a=e.split("="),o=(0,b.A)(a,2),n=o[0],i=o[1];return Object.assign(Object.assign({},t),(0,V.A)({},n,i))}),{}):{}}function na(t){return"#"+Object.entries(t).map((function(t){var e=(0,b.A)(t,2),a=e[0],o=e[1];return"".concat(a,"=").concat(o)})).join("&")}var ia=["lat","lng","zoom"],ra=new(function(){function t(){(0,B.A)(this,t),this.s={},this.lng=this.defineGetterSetter("lng"),this.lat=this.defineGetterSetter("lat"),this.zoom=this.defineGetterSetter("zoom")}return(0,G.A)(t,[{key:"load",value:function(t){var e=oa(t.hash),a=e.map,o=/([\d.]+)\/([\d.]+)\/([\d.]+)$/.exec(a);null!==o&&(this.s.zoom=parseFloat(o[1]),this.s.lng=parseFloat(o[2]),this.s.lat=parseFloat(o[3]))}},{key:"dumps",value:function(){var t,e=this;return ia.some((function(t){return"undefined"===typeof e.s[t]}))?"":"#map=".concat(null===(t=this.s.zoom)||void 0===t?void 0:t.toFixed(2),"/").concat(this.s.lng,"/").concat(this.s.lat)}},{key:"defineGetterSetter",value:function(t){var e=this;return function(){return arguments.length>0&&(e.s[t]=arguments.length<=0?void 0:arguments[0]),e.s[t]}}}])}());function sa(t,e,a){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function o(){var n,i,r,s;return(0,F.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n=oa(e.hash),i=n.factoryId,r=(0,I.Tt)(n,["factoryId"]),i){o.next=3;break}return o.abrupt("return");case 3:return o.next=5,Ie(i);case 5:if(s=o.sent,s){o.next=8;break}return o.abrupt("return");case 8:t.addFactories([s]),t.mapInstance.setCoordinate(s.lng,s.lat),e.hash=na(r),a(i);case 12:case"end":return o.stop()}}),o)})))}var la=function(){return(0,n.dY)()},ca=(0,n.pM)({name:"MapView",components:{DisplaySettingBottomSheet:ue},props:{setFactoryLocation:{type:Function,required:!0}},setup:function(t,e){var a=this,o=Ne(),i=o.event,r=(0,n.KR)(null),s=(0,n.KR)(null),l=(0,n.WQ)(P,(0,n.KR)()),c=(0,n.nI)(),u=Ze(),p=(0,b.A)(u,2),d=p[1],m=ta(),f=(0,b.A)(m,2),v=f[0],y=f[1],g=y.openEditFactoryForm,h=y.pageTransition,_=y.expandFactoryDetail,A=aa(),w=(0,b.A)(A,2),x=w[1],S=function(t){if(l.value){var e=t.get("factoryId"),a=l.value.getFactory(e);a&&(a.feature=t,v.factoryData=a)}},C=function(){l.value&&l.value.mapInstance.map.updateSize()},M=function(){v.factoryData&&g(v.factoryData)};function T(){l.value&&(l.value.mapInstance.setLUILayerVisible(!0),h.startCreateFactory())}(0,n.sV)((function(){var t=new Ve.A({element:s.value,positioning:je.A.BOTTOM_LEFT}),e=function(t,e){return(0,I.sH)(a,void 0,void 0,(0,F.A)().mark((function t(){var a,o,n,r,s,u,p,d,m,f,y,g,h,A,w,x,b,k,I;return(0,F.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return(null===(o=null===(a=v.factoryData)||void 0===a?void 0:a.feature)||void 0===o?void 0:o.get("defaultStyle"))&&(null===(r=null===(n=v.factoryData)||void 0===n?void 0:n.feature)||void 0===r||r.setStyle(null===(u=null===(s=v.factoryData)||void 0===s?void 0:s.feature)||void 0===u?void 0:u.get("defaultStyle"))),e?(i("clickFactoryPin"),e.get("factoryId")?(S(e),(null===(p=null===c||void 0===c?void 0:c.proxy)||void 0===p?void 0:p.$vuetify.breakpoint.mdAndUp)&&_()):(b=e.getGeometry(),k=b.getCoordinates(),null===(f=null===(m=null===(d=null===l||void 0===l?void 0:l.value)||void 0===d?void 0:d.mapInstance)||void 0===m?void 0:m.map)||void 0===f||f.getView().setCenter(k),I=null===(h=null===(g=null===(y=null===l||void 0===l?void 0:l.value)||void 0===y?void 0:y.mapInstance)||void 0===g?void 0:g.map)||void 0===h?void 0:h.getView().getZoom(),null===(x=null===(w=null===(A=null===l||void 0===l?void 0:l.value)||void 0===A?void 0:A.mapInstance)||void 0===w?void 0:w.map)||void 0===x||x.getView().setZoom((I||0)+1))):v.factoryData=null,t.next=4,la();case 4:C();case 5:case"end":return t.stop()}}),t)})))},o=null,n=E()((function(t,e,a){return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function n(){var i;return(0,F.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Fe(t,e,a);case 2:i=n.sent,Array.isArray(i)&&o.addFactories(i);case 4:case"end":return n.stop()}}),n)})))}),500);o=qt(r.value,{onMoved:function(t,e){var a=(0,b.A)(t,4),o=a[0],r=a[1],s=a[2],l=a[3];return(0,I.sH)(this,void 0,void 0,(0,F.A)().mark((function t(){return(0,F.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return ra.lat(r),ra.lng(o),ra.zoom(l),window.location.hash=ra.dumps(),v.canPlaceFactory=e,v.mapLngLat=[o,r],i("moveMap"),t.prev=7,t.next=10,n(s,o,r);case 10:t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](7);case 14:case"end":return t.stop()}}),t,null,[[7,12]])})))},onClicked:e,onZoomed:function(t){ra.zoom(t),window.location.hash=ra.dumps()}},{getInitialLocation:function(){if(ra.load(window.location),""!==ra.dumps())return[ra.lng(),ra.lat(),ra.zoom()]}}),sa(o,window.location,(function(t){var a,n=null===(a=null===l||void 0===l?void 0:l.value)||void 0===a?void 0:a.getFactory(t);if(n){var i=o.getFactoriesLayerForStatus(Gt(n)).getFeatureById(t);e([0,0],i)}})),o.mapInstance.map.addOverlay(t),l.value=o,o.mapInstance.setLUILayerVisible(!1)})),(0,n.sV)((function(){window.addEventListener("resize",C)})),(0,n.hi)((function(){window.removeEventListener("resize",C)}));var O=(0,n.KR)(yt),L=function(t){return O.value.includes(t)},D=function(t){l.value&&(L(t)?O.value=O.value.filter((function(e){return e!==t})):O.value=[].concat((0,k.A)(O.value),[t]),l.value.mapInstance.map.getLayers().forEach((function(t){var e=t.get("factoryStatus");if(void 0!==e){var a="default"===e?e:Number(e);O.value.includes(a)?t.setVisible(!0):t.setVisible(!1)}})))},U=yt.map((function(t){return{text:_t(t),color:At(t),value:t,name:t}}));return{root:r,modalActions:d,popup:s,zoomToGeolocation:function(){if(l.value){i("zoomToGeolocation");try{l.value.mapInstance.zoomToGeolocation()}catch(t){x.showAlert("您沒開放手機定位權限， \n請開放定位權限以用定位功能。")}}},appState:v,onClickEditFactoryData:M,onClickCreateFactoryButton:T,onClickFilterButton:D,filterButtonsData:U,checkActive:L,appliedFilters:O}}}),ua=ca,pa=(0,ne.A)(ua,S,C,!1,null,"4a1d0225",null),da=pa.exports,ma=function(){var t=this,e=t._self._c;t._self._setupProxy;return t.alert?e("div",{staticClass:"app-alert"},[e("div",{staticClass:"close",attrs:{"data-label":"alert-close"},on:{click:t.dismiss}}),e("img",{attrs:{src:"/images/alert.svg",alt:"alert"}}),e("div",[e("div",{staticClass:"alert-title"},[t._v(t._s(t.alert.title))]),e("p",{staticClass:"alert-descriptioin"},[t._v(t._s(t.alert.dismissText))])])]):t._e()},fa=[],va=(0,n.pM)({name:"AppAlert",props:{alert:{type:Object},dismiss:{type:Function}}}),ya=va,ga=(0,ne.A)(ya,ma,fa,!1,null,"91efb6e0",null),ha=ga.exports,_a=a(66319),Aa=a(93059),wa=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"create-factory-steps"},[e(r.A,{staticClass:"d-block d-md-none",attrs:{fixed:"",color:"white"}},[e("div",{staticClass:"btn-container",class:{hide:1===t.appState.createStepIndex}},[e(l.A,{staticClass:"secondary--text",attrs:{icon:""},on:{click:t.onBack}},[e(d.A,[t._v("mdi-keyboard-backspace")])],1)],1),e(_.A),e(A.sw,{staticClass:"secondary--text"},[t._v("新增可疑工廠 步驟 ("+t._s(t.appState.createStepIndex)+"/3)")]),e(_.A),e("div",{staticClass:"btn-container"},[e(p.A,{attrs:{"max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e(l.A,t._g(t._b({staticClass:"secondary--text",attrs:{icon:""}},"v-btn",n,!1),o),[e(d.A,[t._v("mdi-close")])],1)]}}]),model:{value:t.discardDialog,callback:function(e){t.discardDialog=e},expression:"discardDialog"}},[e(c.A,[e(u.ri,{staticClass:"secondary--text"},[t._v("放棄新增可疑工廠嗎？")]),e(u.OQ,[t._v("放棄新增可疑工廠時，你將遺失所有已輸入的資料。下次需重新填寫。")]),e(_a.A,{staticClass:"text-center"},[e(l.A,{attrs:{width:"100%","x-large":"",rounded:"",color:"primary"},on:{click:function(e){t.discardDialog=!1}}},[t._v("繼續填寫資料")]),e("a",{staticClass:"d-block mt-4 text-decoration-underline",on:{click:t.cancelCreateFactory}},[t._v("放棄新增")])],1)],1)],1)],1)],1),e(r.A,{directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.mdAndUp,expression:"$vuetify.breakpoint.mdAndUp"}],attrs:{fixed:"",color:"white"}},[e(A.sw,[t._v("新增可疑工廠")]),e("div",{staticClass:"ml-15 desktop-step-item",on:{click:function(e){return t.switchStep(1)}}},[e("span",[t._v("選擇工廠位置")]),e(d.A,{staticClass:"mr-1"},[t._v("mdi-chevron-right")])],1),e("div",{staticClass:"desktop-step-item",class:{inactive:t.appState.createStepIndex<2},on:{click:function(e){return t.switchStep(2)}}},[e("span",[t._v("上傳工廠照片")]),e(d.A,{staticClass:"mr-1"},[t._v("mdi-chevron-right")])],1),e("div",{staticClass:"desktop-step-item",class:{inactive:t.appState.createStepIndex<3},on:{click:function(e){return t.switchStep(3)}}},[e("span",[t._v("確認及補充工廠資訊")])]),e(_.A),t.$vuetify.breakpoint.mdAndUp?e(p.A,{attrs:{"max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e(l.A,t._g(t._b({attrs:{outlined:""}},"v-btn",n,!1),o),[t._v(" 取消新增 ")])]}}],null,!1,67231085),model:{value:t.discardDialog,callback:function(e){t.discardDialog=e},expression:"discardDialog"}},[e(c.A,[e(u.ri,{staticClass:"secondary--text"},[t._v("放棄新增可疑工廠嗎？")]),e(u.OQ,[t._v("放棄新增可疑工廠時，你將遺失所有已輸入的資料。下次需重新填寫。")]),e(_a.A,{staticClass:"text-center"},[e(l.A,{attrs:{width:"100%","x-large":"",rounded:"",color:"primary"},on:{click:function(e){t.discardDialog=!1}}},[t._v("繼續填寫資料")]),e("a",{staticClass:"d-block mt-4 text-decoration-underline",on:{click:t.cancelCreateFactory}},[t._v("放棄新增")])],1)],1)],1):t._e()],1),1===t.appState.createStepIndex?e("div",{staticClass:"create-factory-step-1"},[t.showLongLat?e("div",{staticClass:"select-location-container container-fluid pa-3 py-md-5 px-md-10",class:{desktop:t.$vuetify.breakpoint.mdAndUp}},[e("div",{staticClass:"d-flex flex-md-row justify-space-between align-end align-md-center"},[e("div",{staticClass:"d-flex flex-column flex-md-row align-start align-md-center justify-space-between justify-md-start flex-grow-1"},[e("p",{staticClass:"mb-4 my-md-3 mr-md-10 wgs"},[t._v("以下經緯度版本為WGS84")]),t.inlineLocationForm?t._e():e("p",{staticClass:"font-weight-medium h5 mb-0 mb-1-md mr-md-10 location-text"},[t._v(" 經度："+t._s(t.appState.mapLngLat[0].toFixed(7))+" ")]),t.inlineLocationForm?t._e():e("p",{staticClass:"font-weight-medium h5 mb-0 mr-md-8 location-text"},[t._v(" 緯度："+t._s(t.appState.mapLngLat[1].toFixed(7))+" ")]),t.inlineLocationForm?t._e():e(l.A,{staticClass:"mr-2 d-none d-md-block primary--text",attrs:{rounded:"",color:"white"},on:{click:t.toggleInlineLocationForm}},[t._v(" 搜尋經緯度 ")]),t.inlineLocationForm?e("div",{staticClass:"d-none d-md-flex justify-space-between align-center flex-grow-1"},[e("div",{staticClass:"d-flex align-center"},[e("p",{staticClass:"font-weight-medium h5 mb-0 mr-7"},[t._v(" 搜尋經緯度 ")]),e("div",{staticClass:"d-block mr-7",staticStyle:{height:"36px",width:"1px","background-color":"#EAF3BF"}}),e("h5",{staticClass:"mr-2"},[t._v("經度")]),e(Aa.A,{staticClass:"mr-7",attrs:{"hide-details":"",outilned:"",solo:"",placeholder:"例：121.5231872",dense:""},model:{value:t.locationInputState.longitude,callback:function(e){t.$set(t.locationInputState,"longitude",e)},expression:"locationInputState.longitude"}}),e("h5",{staticClass:"mr-2"},[t._v("緯度")]),e(Aa.A,{staticClass:"mr-7",attrs:{"hide-details":"",outilned:"",solo:"",placeholder:"例：25.0458344",dense:""},model:{value:t.locationInputState.latitude,callback:function(e){t.$set(t.locationInputState,"latitude",e)},expression:"locationInputState.latitude"}}),e("h5",{staticClass:"text-decoration-underline mr-5",staticStyle:{cursor:"pointer"},on:{click:t.clearLocationInput}},[t._v("清空")]),e(l.A,{staticClass:"primary--text",attrs:{rounded:"",color:"white"},on:{click:t.setLocation}},[t._v("定位")])],1),t.inlineLocationForm?e("div",{staticClass:"d-flex align-center"},[e("div",{staticClass:"d-block d-none d-md-block mx-7",staticStyle:{height:"36px",width:"1px","background-color":"#EAF3BF"}}),e(l.A,{staticClass:"primary--text",attrs:{icon:""},on:{click:t.toggleInlineLocationForm}},[e(d.A,{attrs:{color:"white"}},[t._v("mdi-close")])],1)],1):t._e()]):t._e()],1),e(p.A,{attrs:{"max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e(l.A,t._g(t._b({staticClass:"mr-2 d-md-none primary--text",attrs:{rounded:"",color:"white"}},"v-btn",n,!1),o),[t._v(" 搜尋經緯度 ")])]}}],null,!1,1129603853),model:{value:t.chooseLocationDialog,callback:function(e){t.chooseLocationDialog=e},expression:"chooseLocationDialog"}},[e(c.A,{staticClass:"primary",attrs:{outlined:""}},[e(u.OQ,{staticClass:"pt-4 white--text"},[e("p",[t._v(" 以下經緯度版本為WGS84 ")]),e("h3",{staticClass:"mb-2"},[t._v("經度")]),e(Aa.A,{attrs:{outilned:"",solo:"",placeholder:"例：121.5231872"},model:{value:t.locationInputState.longitude,callback:function(e){t.$set(t.locationInputState,"longitude",e)},expression:"locationInputState.longitude"}}),e("h3",{staticClass:"mb-2"},[t._v("緯度")]),e(Aa.A,{attrs:{outilned:"",solo:"",placeholder:"例：25.0458344"},model:{value:t.locationInputState.latitude,callback:function(e){t.$set(t.locationInputState,"latitude",e)},expression:"locationInputState.latitude"}}),e("div",{staticClass:"d-flex justify-space-between mt-3 align-end"},[e("a",{staticClass:"text-decoration-underline white--text",staticStyle:{height:"36px","line-height":"36px"},on:{click:t.clearLocationInput}},[t._v("清空")]),e(l.A,{staticClass:"primary--text",attrs:{rounded:"",color:"white"},on:{click:t.setLocation}},[t._v("定位")])],1)],1)],1)],1)],1)]):t._e(),e("div",{staticClass:"px-5 py-4"},[e(l.A,{staticClass:"mr-2 primary--text",attrs:{rounded:"",color:"white"},on:{click:t.toggleShowLongLat}},[t._v(" "+t._s(t.showLongLat?"隱藏經緯度":"顯示經緯度")+" ")]),e("switch-map-mode-button"),e(_a.A,{staticClass:"choose-location-btn-container d-flex justify-center",attrs:{fluid:"",bottom:"50"}},[e(l.A,{staticClass:"px-md-15",attrs:{"x-large":"",rounded:"",color:"secondary"},on:{click:t.chooseLocation}},[t._v(" 選擇此地點 ")])],1)],1)]):t._e(),2===t.appState.createStepIndex?e("image-upload-form",{attrs:{uploading:t.imageUploadState.uploading,error:t.imageUploadState.error,previewImages:t.uploadedImages,onClickRemoveImage:t.onClickRemoveImage,valid:t.imageUploadFormValid,submit:t.pageTransition.gotoNextCreate,formState:t.formState},model:{value:t.selectedImages,callback:function(e){t.selectedImages=e},expression:"selectedImages"}}):t._e(),3===t.appState.createStepIndex?e("confirm-factory",{attrs:{formState:t.formState,previewImages:t.uploadedImages,submit:t.submitFactory}}):t._e()],1)},xa=[],ba=function(){var t=(0,n.KR)([]),e=(0,n.Kh)({error:null,uploading:!1}),a=(0,n.KR)(null);(0,n.wB)(a,(function(){e.error=null,a.value&&(e.uploading=!0,Pe(a.value).then((function(e){t.value=[].concat((0,k.A)(t.value),(0,k.A)(e))})).catch((function(t){console.error(t),e.error=!0})).finally((function(){e.uploading=!1})))}));var o=function(e){var a=e.src;t.value=t.value.filter((function(t){return t.src!==a}))},i=(0,n.EW)((function(){return t.value.length>0&&!e.uploading}));return{selectedImages:a,imageUploadState:e,uploadedImages:t,onClickRemoveImage:o,imageUploadFormValid:i}},Sa=function(){var t=(0,n.KR)([]),e={error:null,uploading:!1},a=(0,n.KR)(null);(0,n.wB)(a,(function(){if(a.value){var e=Array.from(a.value).map((function(t){return URL.createObjectURL(t)})).map((function(t){return{src:t,token:t}}));t.value=[].concat((0,k.A)(t.value),(0,k.A)(e))}}));var o=function(e){var a=e.src;t.value=t.value.filter((function(t){return t.src!==a}))},i=(0,n.EW)((function(){return t.value.length>0}));return{selectedImages:a,imageUploadState:e,uploadedImages:t,onClickRemoveImage:o,imageUploadFormValid:i}},Ca=a(7180),ka=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"image-upload-form w-100"},[e(_a.A,{staticClass:"pt-3 pt-md-12 pb-md-8",staticStyle:{"max-width":"630px",position:"relative"}},[e("h2",{staticClass:"mb-4 secondary--text"},[t._v("上傳工廠照片")]),e("p",[t._v("請至少上傳一張工廠照片。")]),e("h3",{staticClass:"mb-3 mt-7 primary--text required"},[t._v("工廠照片")]),e("div",{staticClass:"flex align-items-center mb-3"},[e(l.A,{staticClass:"mr-3",attrs:{disabled:t.uploading,outlined:""}},[e("label",[e("input",{ref:"image",staticStyle:{display:"none"},attrs:{multiple:"",type:"file",accept:"image/*",disabled:t.uploading},on:{change:t.onChange}}),t._v(" 新增照片 ")])]),t.uploading&&!t.disableProgressiveUpload?e("span",[t._v("上傳中...")]):t._e(),!t.valid||t.uploading||t.error||t.disableProgressiveUpload?t._e():e("span",[t._v(" 上傳成功 "),e(d.A,{staticClass:"primary--text"},[t._v("mdi-checkbox-marked-circle")])],1),t.error&&!t.disableProgressiveUpload?e("span",[t._v("上傳錯誤")]):t._e()],1),e("div",{staticClass:"preview-images-container mb-2"},t._l(t.previewImages,(function(a){return e("div",{key:a.token,staticClass:"uploaded-image"},[e("img",{attrs:{src:a.src}}),e("button",{staticClass:"remove-image-btn",on:{click:function(e){return t.removeImage(a)}}})])})),0),e("hr"),e("h2",{staticClass:"mt-7 mb-2 secondary--text"},[t._v("聯絡資訊（非必填）")]),e("p",[t._v(" 如果對於照片有疑問，"),e("br"),t._v(" 我們會透過以下提供的資訊聯絡你。"),e("br"),t._v(" 如不願揭露自己身份，可跳過不填。 ")]),e("h3",{staticClass:"primary--text mt-7 mb-2"},[t._v("聯絡人暱稱")]),e(Aa.A,{attrs:{outlined:"",placeholder:"例：林先生、林小姐",value:t.formState.nickname},on:{input:function(e){return t.$emit("update:formState",(0,Ca.A)((0,Ca.A)({},t.formState),{},{nickname:e}))}}}),e("h3",{staticClass:"primary--text mt-7 mb-2"},[t._v("聯絡方式 (email或電話)")]),e(Aa.A,{attrs:{outlined:"",placeholder:"例：abc@email.com、0920-123456",value:t.formState.contact},on:{input:function(e){return t.$emit("update:formState",(0,Ca.A)((0,Ca.A)({},t.formState),{},{contact:e}))}}}),e("div",{staticClass:"bottom-button-container w-100 d-flex justify-center align-items-center px-xs-3 pb-md-9"},[e(l.A,{staticStyle:{width:"100%","max-width":"345px"},attrs:{"x-large":"",rounded:"",disabled:!t.valid,color:"primary"},on:{click:t.onSubmit}},[t._v(" "+t._s(t.submitText||"下一步")+" ")])],1)],1)],1)},Fa=[],Ia=(0,n.pM)({props:{previewImages:{type:Array,default:function(){return[]}},uploading:{default:!1},error:{default:null},onClickRemoveImage:{type:Function},submit:{type:Function},valid:{type:Boolean,default:!1},formState:{type:Object},submitText:{type:String},disableProgressiveUpload:{type:Boolean,default:!1}},name:"ImageUploadForm",setup:function(t,e){return{images:[],onChange:function(t){e.emit("input",t.target.files)},onSubmit:function(){t.valid&&"function"===typeof t.submit&&t.submit()},removeImage:function(e){t.onClickRemoveImage(e)}}}}),Ma=Ia,Ea=(0,ne.A)(Ma,ka,Fa,!1,null,"0d0d6a7c",null),Ta=Ea.exports,Oa=a(83419),La=a(21567),Da=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"confirm-factory-page"},[e(_a.A,{staticClass:"pt-3 pt-md-12",staticStyle:{"max-width":"630px",position:"relative"}},[e("h2",{staticClass:"mt-2 mb-2 secondary--text"},[t._v("確認及補充工廠資訊")]),e("p",[t._v("請確認工廠地點及照片，並補充工廠資訊。")]),e("h3",{staticClass:"mt-7 mb-2 required primary--text"},[t._v("工廠地點")]),e("p",[t._v(" 返回"),e("a",{on:{click:t.gotoStepOne}},[t._v("步驟(1/3)")]),t._v("編輯 ")]),e("div",{staticClass:"d-flex flex-column flex-md-row justify-md-between"},[e("div",{staticClass:"w-100 minimap-container",class:{desktop:t.$vuetify.breakpoint.mdAndUp},staticStyle:{position:"relative"}},[e("minimap",{attrs:{initialFactories:t.initialFactories,initialLocation:t.initialLocation,pinLocation:t.appState.factoryLocation}}),e("div",{staticClass:"minimap-overlay",on:{click:t.gotoStepOne}})],1),e("div",{staticClass:"d-flex justify-between mt-3 mt-md-0 ml-md-4 d-md-inline-flex flex-md-column justify-md-start"},[e("p",[t._v(" 經度："+t._s(t.appState.factoryLocation[0].toFixed(7))+" "),e("br"),t._v(" 緯度："+t._s(t.appState.factoryLocation[1].toFixed(7))+" ")]),e("p",[e("small",[t._v("以上經緯度版本為WGS84")])])])]),e("h3",{staticClass:"mt-7 mb-2 required primary--text"},[t._v("工廠照片")]),e("p",[t._v(" 返回"),e("a",{on:{click:t.gotoStepTwo}},[t._v("步驟(2/3)")]),t._v("編輯 ")]),e("div",{staticClass:"preview-images-container mb-2"},t._l(t.previewImages,(function(t){return e("div",{key:t.token,staticClass:"uploaded-image"},[e("img",{attrs:{src:t.src}})])})),0),e("h3",{staticClass:"mt-5 mb-2 primary--text"},[t._v("聯絡人暱稱")]),e("p",[t._v(t._s(t.formState.nickname||"未填寫"))]),e("h3",{staticClass:"mt-5 mb-2 primary--text"},[t._v("聯絡方式 (email或電話)")]),e("p",[t._v(t._s(t.formState.contact||"未填寫"))]),e("hr"),e("h2",{staticClass:"mt-5 secondary--text mb-5"},[t._v("其他工廠資訊（非必填）")]),e("p",[t._v("提供明確的工廠資訊能夠幫助我們更快速的填寫公文。")]),e("h3",{staticClass:"mt-5 mb-2 primary--text"},[t._v("工廠描述")]),e(La.A,{attrs:{outlined:"",solo:"",value:t.formState.others,placeholder:"例：常常散發異味"},on:{input:function(e){return t.$emit("update:formState",(0,Ca.A)((0,Ca.A)({},t.formState),{},{others:e}))}}}),e("h3",{staticClass:"mt-5 mb-2 primary--text"},[t._v("工廠外部文字")]),e(Aa.A,{attrs:{outlined:"",value:t.formState.name,placeholder:"例：小明化工廠",color:"primary"},on:{input:function(e){return t.$emit("update:formState",(0,Ca.A)((0,Ca.A)({},t.formState),{},{name:e}))}}}),e("h3",{staticClass:"mt-5 mb-2 primary--text"},[t._v("工廠類型")]),e(Oa.A,{attrs:{items:t.factoryTypeItems,value:t.formState.type,solo:"",outlined:"",placeholder:"未選擇"},on:{input:function(e){return t.$emit("update:formState",(0,Ca.A)((0,Ca.A)({},t.formState),{},{type:e}))}}}),e("div",{staticClass:"bottom-button-container w-100 d-flex justify-center align-items-center px-xs-3 pb-md-9"},[e(l.A,t._g(t._b({staticStyle:{width:"100%","max-width":"345px"},attrs:{"x-large":"",rounded:"",color:"primary"},on:{click:t.submit}},"v-btn",t.attrs,!1),t.on),[t._v(" 確認送出 ")])],1)],1)],1)},Ua=[],Pa=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{ref:"minimap"})},Ra=[],za=(0,n.pM)({props:{initialLocation:{type:Array,default:function(){return[]}},pinLocation:{type:Array,default:function(){return[]}},initialFactories:{type:Array,default:function(){return[]}}},name:"MinimapView",setup:function(t){var e=(0,n.KR)(null);return(0,n.sV)((function(){var a,o=Xt(e.value,t.initialLocation);o.addFactories(t.initialFactories),(a=o.mapInstance).setMinimapPin.apply(a,(0,k.A)(t.pinLocation))})),{minimap:e}}}),Ba=za,Ga=(0,ne.A)(Ba,Pa,Ra,!1,null,null,null),Va=Ga.exports,ja=(0,n.pM)({name:"ConfirmFactory",components:{Minimap:Va},props:{formState:{type:Object,default:function(){return{}}},previewImages:{type:Array,default:function(){return[]}},submit:{type:Function}},emits:["update:formState"],setup:function(){var t,e,a=(0,n.WQ)(P,(0,n.KR)()),o=ta(),i=(0,b.A)(o,2),r=i[0],s=i[1].pageTransition,l=null===(t=a.value)||void 0===t?void 0:t.factories,c=null===(e=a.value)||void 0===e?void 0:e.mapInstance.map.getView().getCenter(),u=(0,k.A)(vt);return{appState:r,initialFactories:l,initialLocation:c,gotoStepOne:function(){a.value&&(s.gotoCreateStep(0),a.value.mapInstance.setLUILayerVisible(!0))},gotoStepTwo:function(){s.gotoCreateStep(1)},factoryTypeItems:u}}}),Na=ja,Wa=(0,ne.A)(Na,Da,Ua,!1,null,"993177d2",null),Ka=Wa.exports;function Ha(t){var e=function(e){"backPressed"===e.state&&t()};window.history.pushState("backPressed","",null),window.history.pushState("dummy","",null),window.addEventListener("popstate",e,{once:!0}),(0,n.hi)((function(){window.removeEventListener("popstate",e)}))}var $a=(0,n.pM)({name:"CreateFactorySteps",components:{ImageUploadForm:Ta,ConfirmFactory:Ka,SwitchMapModeButton:re},setup:function(){var t=this,e=ta(),a=(0,b.A)(e,2),o=a[0],i=a[1],r=i.pageTransition,s=i.setFactoryLocation,l=Ze(),c=(0,b.A)(l,2),u=c[1].openCreateFactorySuccessModal,p=aa(),d=(0,b.A)(p,2),m=d[1],f=Ne(),v=f.event,y=(0,n.KR)(!1),g=(0,n.WQ)(P,(0,n.KR)());function h(){g.value&&(g.value.mapInstance.setLUILayerVisible(!1),y.value=!1,r.closeFactoryPage())}var _=function(){1===o.createStepIndex?h():2===o.createStepIndex?g.value&&(g.value.mapInstance.setLUILayerVisible(!0),r.previousCreateStep()):r.previousCreateStep()};Ha(_);var A=(0,n.Kh)({nickname:"",contact:"",others:"",name:"",type:void 0,submitting:!1}),w=ba(),x=w.selectedImages,S=w.imageUploadState,C=w.uploadedImages,k=w.onClickRemoveImage,M=w.imageUploadFormValid,E=function(){return(0,I.sH)(t,void 0,void 0,(0,F.A)().mark((function t(){var e,a,n,i,s;return(0,F.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return A.submitting=!0,t.prev=1,e=(0,b.A)(o.factoryLocation,2),a=e[0],n=e[1],i={name:A.name,others:A.others,type:A.type,lng:a,lat:n,images:C.value.map((function(t){return t.token})),nickname:A.nickname,contact:A.contact},v("createFactory",{lng:a,lat:n}),t.next=7,ze(i);case 7:s=t.sent,g.value&&g.value.addFactories([s]),t.next=13;break;case 11:t.prev=11,t.t0=t["catch"](1);case 13:return t.prev=13,A.submitting=!1,t.finish(13);case 16:r.closeFactoryPage(),u();case 18:case"end":return t.stop()}}),t,null,[[1,11,13,16]])})))},T=(0,n.KR)(!1),O=function(){T.value=!T.value},L=(0,n.KR)(!1),D=(0,n.KR)(!1),U=function(){D.value=!D.value},R=(0,n.Kh)({longitude:"",latitude:""}),z=function(){R.longitude="",R.latitude=""},B=function(){if(g.value){var t=parseFloat(R.longitude),e=parseFloat(R.latitude);if(!R.longitude||!R.latitude||isNaN(t)||isNaN(e))L.value=!1;else{var a=g.value.mapInstance.map.getView().getZoom();(!a||a<=17)&&(a=17),g.value.mapInstance.setCoordinate(t,e,a),L.value=!1}}},G=function(t){for(var e=o.createStepIndex-t,a=0;a<e;a++)_()};return{appState:o,pageTransition:r,formState:A,cancelCreateFactory:h,onBack:_,chooseLocation:function(){g.value&&(o.canPlaceFactory?(g.value.mapInstance.setLUILayerVisible(!1),s(o.mapLngLat),r.nextCreateStep()):m.showAlert("此地點不在農地範圍內，\n請回報在農地範圍內的工廠。"))},selectedImages:x,imageUploadState:S,uploadedImages:C,onClickRemoveImage:k,imageUploadFormValid:M,discardDialog:y,submitFactory:E,showLongLat:T,toggleShowLongLat:O,chooseLocationDialog:L,inlineLocationForm:D,locationInputState:R,clearLocationInput:z,toggleInlineLocationForm:U,setLocation:B,switchStep:G}}}),Ya=$a,Za=(0,ne.A)(Ya,wa,xa,!1,null,"06e1f5c6",null),Qa=Za.exports,Ja=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"update-factory-steps"},[e(r.A,{staticClass:"d-block d-md-none",attrs:{fixed:"",color:"white"}},[e(_.A),t.appState.isEditImagesMode?e(A.sw,{staticClass:"secondary--text"},[t._v("補充照片")]):e(A.sw,{staticClass:"secondary--text"},[t._v(" "+t._s(t.updateFormAppTitle)+" ")]),e(_.A),e("div",{staticClass:"btn-container"},[e(p.A,{attrs:{"max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e(l.A,t._g(t._b({attrs:{icon:""}},"v-btn",n,!1),o),[e(d.A,[t._v("mdi-close")])],1)]}}]),model:{value:t.discardDialog,callback:function(e){t.discardDialog=e},expression:"discardDialog"}},[t.appState.isEditImagesMode?e(c.A,[e(u.ri,{staticClass:"headline"},[t._v("補充照片尚未完成")]),e(u.OQ,[t._v("放棄補充照片的話，你將遺失所有未新增的資料。下次需重新上傳照片")]),e(_a.A,{staticClass:"text-center"},[e(l.A,{attrs:{width:"100%","x-large":"",rounded:"",color:"green darken-1"},on:{click:function(e){t.discardDialog=!1}}},[t._v("繼續編輯")]),e("a",{staticClass:"d-block mt-4",on:{click:t.cancelUpdateFactoryImages}},[t._v("確定放棄")])],1)],1):e(c.A,[e(u.ri,{staticClass:"secondary--text"},[t._v(t._s(t.updateFormAppTitle)+"尚未完成！")]),e(u.OQ,[t._v("放棄編輯的話，你將遺失所有未新增的資料。下次需重新填寫。")]),e(_a.A,{staticClass:"text-center"},[e(l.A,{attrs:{width:"100%","x-large":"",rounded:"",color:"primary"},on:{click:function(e){t.discardDialog=!1}}},[t._v("繼續編輯")]),e("a",{staticClass:"d-block mt-4",on:{click:t.cancelUpdateFactory}},[t._v("確定放棄")])],1)],1)],1)],1)],1),t.appState.isEditImagesMode?e(r.A,{staticClass:"d-none d-md-block",attrs:{fixed:"",color:"white"}},[e(A.sw,{staticClass:"secondary--text"},[t._v("補充照片")]),e(_.A),e(p.A,{attrs:{"max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[e(l.A,t._g(t._b({attrs:{outlined:""}},"v-btn",n,!1),o),[t._v(" 取消 ")])]}}],null,!1,1770517635),model:{value:t.discardDialog,callback:function(e){t.discardDialog=e},expression:"discardDialog"}},[e(c.A,[e(u.ri,{staticClass:"secondary--text"},[t._v("補充照片尚未完成")]),e(u.OQ,[t._v("放棄補充照片的話，你將遺失所有未新增的資料。下次需重新上傳照片")]),e(_a.A,{staticClass:"text-center"},[e(l.A,{attrs:{width:"100%","x-large":"",rounded:"",color:"primary"},on:{click:function(e){t.discardDialog=!1}}},[t._v("繼續編輯")]),e("a",{staticClass:"d-block mt-4",on:{click:t.cancelUpdateFactoryImages}},[t._v("確定放棄")])],1)],1)],1)],1):t._e(),t.appState.isEditImagesMode?e("image-upload-form",{attrs:{uploading:t.imageUploadState.uploading,error:t.imageUploadState.error,previewImages:t.uploadedImages,onClickRemoveImage:t.onClickRemoveImage,valid:t.imagesValid,submit:t.submitImageUpload,formState:t.imageUploadFormState,submitText:t.imageSubmitting?"照片上傳中...":"確認新增照片",disableProgressiveUpload:""},model:{value:t.selectedImages,callback:function(e){t.selectedImages=e},expression:"selectedImages"}}):t.$vuetify.breakpoint.smAndDown?e("div",{staticClass:"update-factory-comment-container w-100 px-4 py-4 d-flex flex-column justify-between"},[e("div",[e("h3",{staticClass:"mt-4 mb-2 primary--text"},[t._v(t._s(t.updateFormTitle))]),t.appState.isEditComment?e(La.A,{attrs:{outlined:"",solo:"",placeholder:"例：常常散發異味"},model:{value:t.formState.others,callback:function(e){t.$set(t.formState,"others",e)},expression:"formState.others"}}):t._e(),t.appState.isEditName?e(Aa.A,{attrs:{outlined:"",placeholder:"例：小明化工廠",color:"primary"},model:{value:t.formState.name,callback:function(e){t.$set(t.formState,"name",e)},expression:"formState.name"}}):t._e(),t.appState.isEditType?e(Oa.A,{attrs:{items:t.factoryTypeItems,solo:"",outlined:"",placeholder:"未選擇"},model:{value:t.formState.factory_type,callback:function(e){t.$set(t.formState,"factory_type",e)},expression:"formState.factory_type"}}):t._e()],1),e(l.A,{staticClass:"w-100 primary",staticStyle:{width:"100%","max-width":"345px",margin:"0 auto"},attrs:{"x-large":"",rounded:"",disabled:!t.isCurrentFieldValid},on:{click:t.submitUpdateFactory}},[t._v(" "+t._s(t.updateFormButton)+" ")])],1):t._e(),t.$vuetify.breakpoint.mdAndUp?e(p.A,{attrs:{persistent:"","max-width":"395"},model:{value:t.appState.isEditFactoryMode,callback:function(e){t.$set(t.appState,"isEditFactoryMode",e)},expression:"appState.isEditFactoryMode"}},[e("div",{staticClass:"update-factory-comment-modal w-100 px-4 py-4 d-flex flex-column justify-between"},[e("div",{staticClass:"d-flex justify-end"},[e(l.A,{attrs:{icon:""},on:{click:t.cancelUpdateFactory}},[e(d.A,[t._v("mdi-close")])],1)],1),e("div",[e("h3",{staticClass:"mb-3"},[t._v(t._s(t.updateFormTitle))]),t.appState.isEditComment?e(La.A,{attrs:{outlined:"",solo:"",placeholder:"例：常常散發異味"},model:{value:t.formState.others,callback:function(e){t.$set(t.formState,"others",e)},expression:"formState.others"}}):t._e(),t.appState.isEditName?e(Aa.A,{attrs:{outlined:"",placeholder:"例：小明化工廠",color:"primary"},model:{value:t.formState.name,callback:function(e){t.$set(t.formState,"name",e)},expression:"formState.name"}}):t._e(),t.appState.isEditType?e(Oa.A,{attrs:{items:t.factoryTypeItems,solo:"",outlined:"",placeholder:"未選擇"},model:{value:t.formState.factory_type,callback:function(e){t.$set(t.formState,"factory_type",e)},expression:"formState.factory_type"}}):t._e()],1),e(l.A,{staticClass:"w-100",staticStyle:{width:"100%","max-width":"345px",margin:"0 auto"},attrs:{"x-large":"",rounded:"",disabled:!t.isCurrentFieldValid,color:"primary"},on:{click:t.submitUpdateFactory}},[t._v(" "+t._s(t.updateFormButton)+" ")])],1)]):t._e()],1)},qa=[],Xa=(0,n.pM)({name:"UpdateFactorySteps",components:{ImageUploadForm:Ta},setup:function(){var t,e,a=this,o=ta(),i=(0,b.A)(o,2),r=i[0],s=i[1].pageTransition,l=Ze(),c=(0,b.A)(l,2),u=c[1],p=(0,n.WQ)(P,(0,n.KR)()),d=Ne(),m=d.event,f=Sa(),v=f.selectedImages,y=f.imageUploadState,g=f.uploadedImages,h=f.onClickRemoveImage,_=f.imageUploadFormValid,A=(0,n.Kh)({nickname:"",contact:""}),w=(0,n.KR)(!1),x=(0,n.EW)((function(){return _.value&&!w.value})),S=function(){return(0,I.sH)(a,void 0,void 0,(0,F.A)().mark((function t(){var e,a,o,n;return(0,F.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if((null===(e=r.factoryData)||void 0===e?void 0:e.id)&&v.value){t.next=2;break}return t.abrupt("return");case 2:return w.value=!0,t.prev=3,t.next=6,Re(null===(a=r.factoryData)||void 0===a?void 0:a.id,v.value,{nickname:A.nickname,contact:A.contact});case 6:o=t.sent,p.value&&(n=r.factoryData,n.images=n.images.concat(o),p.value.updateFactory(n.id,n),r.factoryData=n),s.cancelUpdateFactoryImages(),u.openUpdateFactoryImagesSuccessModal(),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](3),console.error(t.t0);case 15:w.value=!1;case 16:case"end":return t.stop()}}),t,null,[[3,12]])})))},C=(0,n.KR)(!1),M=function(){C.value=!1,s.cancelUpdateFactoryImages()},E=function(){C.value=!1,s.cancelUpdateFactoryComment()},T=(0,n.Kh)({others:"",name:null===(t=r.factoryData)||void 0===t?void 0:t.name,factory_type:null===(e=r.factoryData)||void 0===e?void 0:e.type,submitting:!1}),O=(0,k.A)(vt),L={others:(0,n.EW)((function(){return T.others.length>0&&!T.submitting})),name:(0,n.EW)((function(){var t,e;return(null===(t=null===T||void 0===T?void 0:T.name)||void 0===t?void 0:t.length)&&(null===(e=T.name)||void 0===e?void 0:e.length)>0&&!T.submitting})),factory_type:(0,n.EW)((function(){return!!T.factory_type&&!T.submitting}))},D=(0,n.EW)((function(){var t=r.updateFactoryField;return L[t].value})),U=(0,n.EW)((function(){return r.isEditComment?"補充工廠描述":r.isEditName?"更改外部文字":"更改工廠類型"})),R=(0,n.EW)((function(){return r.isEditComment?"工廠描述":r.isEditName?"工廠外部文字":r.isEditType?"工廠類型":void 0})),z=(0,n.EW)((function(){return r.isEditComment?"新增工廠描述":r.isEditName?"確認更改工廠外部文字":r.isEditType?"確認更改工廠類型":void 0})),B=function(){return(0,I.sH)(a,void 0,void 0,(0,F.A)().mark((function t(){var e,a,o,n;return(0,F.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if((null===(e=r.factoryData)||void 0===e?void 0:e.id)&&D.value){t.next=2;break}return t.abrupt("return");case 2:return T.submitting=!0,t.prev=3,o=r.updateFactoryField,m("updateFactory",{field:o}),t.next=8,Be(null===(a=r.factoryData)||void 0===a?void 0:a.id,(0,V.A)({},o,T[o]));case 8:n=t.sent,p.value&&(p.value.updateFactory(n.id,n),r.factoryData=n),s.cancelUpdateFactoryComment(),u.openUpdateFactorySuccessModal(),t.next=16;break;case 14:t.prev=14,t.t0=t["catch"](3);case 16:T.submitting=!1;case 17:case"end":return t.stop()}}),t,null,[[3,14]])})))};return{appState:r,pageTransition:s,discardDialog:C,imageUploadFormState:A,selectedImages:v,imageUploadState:y,uploadedImages:g,onClickRemoveImage:h,imagesValid:x,submitImageUpload:S,cancelUpdateFactoryImages:M,cancelUpdateFactory:E,updateFormAppTitle:U,updateFormTitle:R,updateFormButton:z,formState:T,isCurrentFieldValid:D,factoryTypeItems:O,submitUpdateFactory:B,imageSubmitting:w}}}),to=Xa,eo=(0,ne.A)(to,Ja,qa,!1,null,"72c2d901",null),ao=eo.exports,oo=a(15625),no=a(69636),io=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e(c.A,{directives:[{name:"show",rawName:"v-show",value:!t.appState.formPageOpen,expression:"!appState.formPageOpen"}],staticClass:"factory-container",class:{full:t.full,desktop:t.$vuetify.breakpoint.mdAndUp,empty:!t.appState.factoryData},attrs:{elevation:"3"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.appState.factoryData,expression:"appState.factoryData"}],ref:"factoryDetailScrollerRef",staticClass:"factory-detail-scroller"},[t.scrollOff?e(r.A,{staticClass:"d-block d-md-none",attrs:{fixed:"",color:"white"}},[e(_.A),e(A.sw,[e(d.A,{staticStyle:{"margin-bottom":"5px"},attrs:{color:t.statusColor}},[t._v("mdi-map-marker")]),t._v(t._s(t.factoryStatusText)+" ")],1),e(_.A),e("div",{staticClass:"btn-container"},[e(d.A,{staticClass:"float-right",on:{click:t.collapseFactoryDetail}},[t._v("mdi-close")]),e(d.A,{staticClass:"float-right mr-4",on:{click:t.copyToClipboard}},[t._v("mdi-share-variant")])],1),t.showCopiedMessage?e("div",{staticClass:"copied-message flex justify-center align-items-center"},[e(d.A,{staticClass:"mr-1",attrs:{color:"white"}},[t._v("mdi-content-copy")]),t._v(" 已複製連結 ")],1):t._e()],1):t._e(),e(u.OQ,[e("div",{staticClass:"d-flex justify-between align-items-center mb-3"},[e("span",{staticClass:"factory-status-title"},[t._v("工廠狀態")]),t.$vuetify.breakpoint.mdAndUp?e(l.A,{attrs:{rounded:"",outlined:t.showCopiedMessage,color:t.showCopiedMessage?null:"white"},on:{click:t.copyToClipboard}},[e(d.A,{staticClass:"mr-1"},[t._v("mdi-share-variant")]),t._v(" "+t._s(t.showCopiedMessage?"已複製連結":"分享工廠")+" ")],1):e("span",[e(d.A,{staticClass:"mr-4",on:{click:t.copyToClipboard}},[t._v("mdi-share-variant")]),e(d.A,{on:{click:t.collapseFactoryDetail}},[t._v("mdi-close")])],1)],1),e("p",{staticClass:"factory-status secondary--text mb-2",staticStyle:{clear:"both"}},[e(d.A,{staticStyle:{"margin-bottom":"5px"},attrs:{color:t.statusColor}},[t._v("mdi-map-marker")]),t._v(t._s(t.factoryStatusText)+" ")],1),e("p",{staticClass:"caption mb-0",staticStyle:{color:"#A1A1A1"}},[t._v(" 工廠編號 "+t._s(t.factoryId)+" "),e("br"),t._v(" "+t._s(t.lastUpdatedAt)+" ")]),t.showCopiedMessage&&!t.scrollOff?e("div",{staticClass:"copied-message flex justify-center align-items-center"},[e(d.A,{staticClass:"mr-1",attrs:{color:"white"}},[t._v("mdi-content-copy")]),t._v(" 已複製連結 ")],1):t._e()]),e(oo.Ay,{ref:"slideGroup",attrs:{"show-arrows":t.images.length>0}},[e(no.A,[e("div",{staticClass:"update-image-button d-flex flex-column justify-center align-items-center",on:{click:t.pageTransition.startUpdateFactoryImages}},[e(d.A,{staticClass:"mb-1",attrs:{color:"white"}},[t._v("mdi-camera-plus")]),t._v(" 補充照片 ")],1)]),t._l(t.images,(function(a,o){return e(no.A,{key:a.id,staticClass:"mr-4",class:{"ml-4":0===o},nativeOn:{click:function(e){return t.setLightboxIndex(o)}}},[e("ImgurFallbackImage",{attrs:{src:a.url,className:"factory-slide-image"}})],1)}))],2),e("div",{staticClass:"mt-4 mx-3 mb-2"},[e("h3",{staticClass:"mb-1"},[t._v("地段 / 地址")]),e("p",{staticClass:"mb-5"},[t._v(t._s(t.factoryAddressAndLandcode))]),t.full||t.$vuetify.breakpoint.mdAndUp?e("div",{staticClass:"mb-5"},[e("h3",{staticClass:"mb-1"},[t._v("經緯度")]),e("p",{staticClass:"mb-1"},[t._v(t._s(t.longitude)+", "+t._s(t.latitude))]),e("p",{staticClass:"text-caption"},[t._v("以上經緯度版本為 WGS84")])]):t._e(),t.source?[e("h3",{staticClass:"mb-1"},[t._v("資料來源")]),e("p",{staticClass:"mb-5"},[t._v(t._s(t.source))])]:t._e(),t.full||t.$vuetify.breakpoint.mdAndUp?e("hr"):t._e(),t.full||t.$vuetify.breakpoint.mdAndUp?t._e():e(l.A,{staticClass:"m-0 mb-0 px-0 v-btn-plain",attrs:{text:"",depressed:"",elevation:"0",ripple:!1,color:"#697F01"},on:{click:t.expandFactoryDetail}},[t._v(" 顯示更多資訊   "),e(d.A,[t._v("mdi-menu-down")])],1),t.full||t.$vuetify.breakpoint.mdAndUp?e("div",{staticClass:"mt-4"},[e("h2",{staticClass:"mb-5"},[t._v("其他工廠資訊")]),e("h3",{staticClass:"mb-1"},[t._v("工廠外部文字")]),t.factoryName?e("p",{staticClass:"mb-3"},[t._v(t._s(t.factoryName))]):t._e(),e(l.A,{staticClass:"d-block mb-5",attrs:{outlined:""},on:{click:function(e){return t.startUpdateFactoryCommentFor("name")}}},[t._v(" "+t._s(t.factoryName?"更改外部文字":"回報外部文字")+" ")]),e("h3",{staticClass:"mb-1"},[t._v("工廠類型")]),t.factoryType?e("p",{staticClass:"mb-3"},[t._v(t._s(t.factoryType))]):t._e(),e(l.A,{staticClass:"d-block mb-5",attrs:{outlined:""},on:{click:function(e){return t.startUpdateFactoryCommentFor("factory_type")}}},[t._v(" "+t._s(t.factoryType?"更改工廠類型":"回報工廠類型")+" ")]),e("h3",{staticClass:"mb-1"},[t._v("工廠描述")]),e(l.A,{staticClass:"mb-2",attrs:{outlined:""},on:{click:function(e){return t.startUpdateFactoryCommentFor("others")}}},[t._v("補充工廠描述")]),t._l(t.pastDescriptions,(function(a,o){return e("div",{key:o,staticClass:"mt-2",staticStyle:{"font-size":"14px"}},[e("p",{staticClass:"color-gray-light mb-1"},[t._v(t._s(a.date))]),e("p",{staticStyle:{"line-height":"24px"}},[t._v(t._s(a.others))])])})),t.factoryFollowups.length>0?[e("h3",{staticClass:"mb-1"},[t._v("政府回應")]),t._l(t.factoryFollowups,(function(a,o){return e("div",{key:o,staticClass:"mt-2",staticStyle:{"font-size":"14px"}},[e("p",{staticStyle:{"line-height":"24px"}},[t._v(t._s(a.note))])])}))]:t._e()],2):t._e()],2)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.appState.factoryData,expression:"!appState.factoryData"}],staticClass:"factory-detail-scroller px-4 py-5"},[e("h1",{staticClass:"secondary--text mb-5"},[t._v("請選擇一個地標")]),e("p",[t._v("請選擇一間工廠查看工廠詳細資訊。")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.mdAndUp,expression:"$vuetify.breakpoint.mdAndUp"}],staticClass:"sidebar-collapse-button d-flex align-items-center justify-center",on:{click:t.toggleFactoryDetail}},[e(d.A,{attrs:{color:"primary"}},[t._v("mdi-menu-left")])],1)]),e("CoolLightBox",{attrs:{items:t.lightboxItems,index:t.lightboxIndex},on:{close:function(){return t.setLightboxIndex(null)}}})],1)},ro=[],so=(a(26910),a(17965)),lo=a.n(so),co=vt.reduce((function(t,e){return Object.assign(Object.assign({},t),(0,V.A)({},e.value,e.text))}),{}),uo=function(t){return t.type?co[t.type]:null},po=function(t){var e=(0,n.KR)(0),a=(0,n.KR)(0),o=function(){if(t.value){var o=t.value;e.value=o.scrollTop,a.value=o.scrollLeft}};return(0,n.wB)(t,(function(t){t&&(e.value=t.scrollTop,a.value=t.scrollLeft,t.addEventListener("scroll",o))})),(0,n.hi)((function(){t.value&&t.value.removeEventListener("scroll",o)})),{scrollTop:e,scrollLeft:a}},mo=po,fo=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("img",{class:t.className,attrs:{src:t.imageUrl,alt:t.alt},on:{error:t.onError}})},vo=[],yo=/i\.imgur\.com\/([a-zA-Z0-9]+)\.([a-zA-Z0-9]+)(\?.*)?$/,go="https://staging.disfactory.tw/imgur",ho=(0,n.pM)({name:"ImgurFallbackImage",props:{src:{type:String,required:!0},alt:{type:String,default:""},className:{type:String,default:""}},setup:function(t,e){var a=(0,n.EW)((function(){var e=yo.exec(t.src);return e?{id:e[1],ext:e[2]}:null})),o=(0,n.EW)((function(){return a.value?"".concat(go,"/").concat(a.value.id,".").concat(a.value.ext):t.src})),i=(0,n.KR)(t.src);(0,n.wB)((function(){return t.src}),(function(t){i.value=t}));var r=function(){i.value=o.value};return{imageUrl:i,onError:r}}}),_o=ho,Ao=(0,ne.A)(_o,fo,vo,!1,null,null,null),wo=Ao.exports,xo=(0,n.pM)({name:"FactoryDetailPage",components:{ImgurFallbackImage:wo},setup:function(){var t,e=ta(),a=(0,b.A)(e,2),o=a[0],i=a[1],r=i.pageTransition,s=i.expandFactoryDetail,l=i.collapseFactoryDetail,c=i.toggleFactoryDetail,u=(0,n.EW)((function(){return o.factoryData?o.factoryData.images:[]})),p=(0,n.EW)((function(){return o.factoryData?o.factoryData.images.map((function(t){return{title:"",description:"",src:t.url}})):[]})),d=(0,n.KR)(null),m=function(t){d.value=t},f=(0,n.EW)((function(){return o.factoryData?Gt(o.factoryData):void 0})),v=(0,n.EW)((function(){return o.factoryData?o.factoryData.follow_ups_for_user:[]})),y=(0,n.EW)((function(){if("undefined"!==typeof f.value){var t=_t(f.value),e=o.factoryData||{},a=e.document_display_status;return a?"".concat(t,"：").concat(a):t}return""})),g=(0,n.EW)((function(){return"undefined"!==typeof f.value?Bt(f.value):null})),h=(0,n.EW)((function(){return o.factoryData?o.factoryData.display_number:""})),_=(0,n.EW)((function(){return o.factoryData?uo(o.factoryData):null})),A=(0,n.EW)((function(){var t;return(null===(t=o.factoryData)||void 0===t?void 0:t.name)||""})),w=(0,n.EW)((function(){if(o.factoryData){var t=o.factoryData,e=t.townname,a=t.sectname,n=t.sectcode,i=t.landcode;return e&&a&&n&&i?"".concat(e," ").concat(a," (").concat(n,") ").concat(i,"地號"):"擷取中"}return""})),x=(0,n.EW)((function(){var t;return o.factoryData?null===(t=o.factoryData.source)||void 0===t?void 0:t.split("").map((function(t){switch(t){case"U":return"本系統";case"G":return"農委會";case"E":return"經濟部";default:return""}})).filter(Boolean).join("、"):""})),S=(0,n.EW)((function(){return o.factoryDetailsExpanded})),C=(0,n.EW)((function(){var t;return null===(t=o.factoryData)||void 0===t?void 0:t.lng.toFixed(7)})),k=(0,n.EW)((function(){var t;return null===(t=o.factoryData)||void 0===t?void 0:t.lat.toFixed(7)})),M=(0,n.KR)(null),E=mo(M),T=E.scrollTop,O=(0,n.EW)((function(){return T.value>29&&S.value})),L=(0,n.KR)(!1),D=function(){var t,e;if(o.factoryData){var a=window.location,n=a.host,i=a.protocol,r="".concat(i,"//").concat(n,"/#map=16/").concat(null===(t=o.factoryData)||void 0===t?void 0:t.lng,"/").concat(null===(e=o.factoryData)||void 0===e?void 0:e.lat,"&factoryId=").concat(o.factoryData.id);lo()(r),L.value=!0,window.setTimeout((function(){L.value=!1}),1e3)}},U=(0,n.KR)(null);(0,n.$u)((function(){var e;if(JSON.stringify(u.value)!==JSON.stringify(t))if(t){if(t=u.value.slice(),U.value){var a=null===(e=U.value)||void 0===e?void 0:e.$refs.content;window.setTimeout((function(){a.style="translateX(0px)"}),50)}}else t=u.value.slice()}));var P=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"others";r.startUpdateFactoryComment(t)},R=(0,n.KR)([]);(0,n.wB)((function(){return o.factoryData}),(function(){var t=this;o.factoryData&&function(){(0,I.sH)(t,void 0,void 0,(0,F.A)().mark((function t(){var e;return(0,F.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ge(null===(e=o.factoryData)||void 0===e?void 0:e.id);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:R.value=t.t0.sort((function(t,e){return new Date(e.created_at)>=new Date(t.created_at)?1:-1}));case 6:case"end":return t.stop()}}),t)})))}()}));var z=(0,n.EW)((function(){return R.value.map((function(t){var e=new Date(t.created_at),a="".concat(e.getFullYear(),"/").concat(e.getMonth()+1,"/").concat(e.getDate());return{date:a,others:t.others}})).filter((function(t){return t.others}))})),B=(0,n.EW)((function(){if(!o.factoryData||!o.factoryData.reported_at)return null;var t;t=0===R.value.length?new Date(o.factoryData.reported_at):new Date(R.value[0].created_at);var e="".concat(t.getFullYear(),"/").concat(t.getMonth()+1,"/").concat(t.getDate());return"最後更新 ".concat(e)}));return{full:S,appState:o,pageTransition:r,images:u,expandFactoryDetail:s,collapseFactoryDetail:l,toggleFactoryDetail:c,factoryStatus:f,factoryStatusText:y,statusColor:g,factoryId:h,factoryType:_,factoryName:A,factoryAddressAndLandcode:w,factoryFollowups:v,source:x,pastDescriptions:z,lastUpdatedAt:B,longitude:C,latitude:k,factoryDetailScrollerRef:M,scrollOff:O,showCopiedMessage:L,copyToClipboard:D,slideGroup:U,startUpdateFactoryCommentFor:P,lightboxItems:p,lightboxIndex:d,setLightboxIndex:m}}}),bo=xo,So=(0,ne.A)(bo,io,ro,!1,null,"d5d4ce3a",null),Co=So.exports,ko=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"about-dialog-container"},[e("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[e("div",{staticClass:"page"},[e("h3",[t._v("關於回報系統")]),e("p",[t._v(" 農地違章工廠舉報系統為協助民眾回報揭露農地違章工廠資訊，並非實際完成舉報。 ")]),e("p",[t._v(" 地球公民基金會將整理資料進行部分案件追蹤，完成舉報者可於「已舉報」案件查見。 ")]),e("p",[t._v(" 105.05.20 前的違章工廠我們將持續收集資訊，但本系統優先針對新增建與中高污染違章工廠進行舉報。 ")]),e("p",[t._v(" 本系統感謝 g0v.tw 社群朋友共同開發。 ")]),e("p",[t._v(" 既有疑似違章工廠資料來源為 2019 年 7 月 30 日取自內政部國土測繪圖資雲"),e("a",{attrs:{href:"https://maps.nlsc.gov.tw/"}},[t._v("網站")]),t._v("。 ")]),e("p",[t._v(" 全站使用者貢獻資料以 "),e("a",{attrs:{href:"https://creativecommons.org/licenses/by/3.0/tw/"}},[t._v("CC BY 姓名標示 3.0")]),t._v(" 釋出，標註「© 農地違章工廠舉報小幫手貢獻者」，原始碼以 MIT 開放授權公開在 "),e("a",{attrs:{href:"https://github.com/Disfactory/Disfactory"}},[t._v("GitHub")]),t._v(" 上 ")])])])],1)},Fo=[],Io=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"app-modal-component",class:{open:t.open},attrs:{"data-testid":"modal-container"}},[e("div",{staticClass:"app-modal-backdrop",attrs:{"data-label":"modal-backdrop"},on:{click:t.dismiss}}),e("div",{staticClass:"app-modal"},[t.showCloseButton?e("div",{staticClass:"close",attrs:{"data-label":"modal-close","data-testid":"modal-close"},on:{click:t.dismiss}}):t._e(),t._t("default")],2)])},Mo=[],Eo=(0,n.pM)({name:"AppModal",props:{open:{type:Boolean,default:!1},dismiss:{type:Function},showCloseButton:{type:Boolean,default:!0}}}),To=Eo,Oo=(0,ne.A)(To,Io,Mo,!1,null,"68da9dd0",null),Lo=Oo.exports,Do=(0,n.pM)({name:"AboutModal",components:{AppModal:Lo},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),Uo=Do,Po=(0,ne.A)(Uo,ko,Fo,!1,null,null,null),Ro=Po.exports,zo=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"contact-modal-container"},[e("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[e("div",{staticClass:"page"},[e("img",{attrs:{width:"137",src:"/images/cet-logo.png",alt:"Citizen of the Earth Taiwan"}}),e("h3",[t._v(" 有任何回報相關問題"),e("br"),t._v(" 歡迎聯絡 ")]),e("p",[t._v(" 地球公民基金會"),e("br"),t._v(" TEL: 02-23920371"),e("br"),t._v(" Email: "),e("a",{attrs:{href:"mailto:cet@cet-taiwan.org"}},[t._v("cet@cet-taiwan.org")]),e("br")])])])],1)},Bo=[],Go=(0,n.pM)({name:"ContactModal",components:{AppModal:Lo},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),Vo=Go,jo=(0,ne.A)(Vo,zo,Bo,!1,null,null,null),No=jo.exports,Wo=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"getting-started-container"},[e("app-modal",{attrs:{open:t.open,showCloseButton:!1,dismiss:t.dismiss}},[e("div",{staticClass:"page"},[e("h3",{staticClass:"text-center"},[t._v("歡迎來到"),e("b",[t._v("農地違章工廠回報系統！")])]),e("br"),e("br"),e("p",[t._v("需要大家回報以下工廠之照片及資訊：")]),e("p",[e("ul",[e("li",[t._v("2016.05.20後新增的農地違章工廠")]),e("li",[t._v("中高污染工廠")])])]),e("p",[t._v("以上資訊將由"),e("b",[t._v("地球公民基金會")]),t._v("彙整後，向政府舉報並追蹤拆除進度。")]),e("small",{staticClass:"text-center",staticStyle:{"padding-left":"20px","padding-right":"20px"}},[t._v(" 行動前請同意資料貢獻"),e("a",{attrs:{href:"https://license.disfactory.tw/#%E8%BE%B2%E5%9C%B0%E9%81%95%E7%AB%A0%E5%B7%A5%E5%BB%A0%E5%9B%9E%E5%A0%B1%E7%B3%BB%E7%B5%B1%EF%BC%88disfactory%EF%BC%89%E8%B2%A2%E7%8D%BB%E5%8D%94%E8%AD%B0",target:"_blank"}},[t._v("授權條款")]),t._v("與"),e("a",{attrs:{href:"https://license.disfactory.tw/#%E9%9A%B1%E7%A7%81%E6%AC%8A%E6%A2%9D%E6%AC%BE",target:"_blank"}},[t._v("隱私條款")]),t._v("。本網站由"),e("a",{attrs:{href:"https://www.cet-taiwan.org/",target:"_blank"}},[t._v("地球公民基金會")]),t._v("與 "),e("a",{attrs:{href:"https://g0v.tw/",target:"_blank"}},[t._v("g0v.tw")]),t._v(" 社群共同開發。 ")]),e("app-button",{on:{click:t.agree}},[t._v("我同意加入回報")]),e("small",[e("a",{attrs:{href:"https://about.disfactory.tw"}},[t._v("我不同意，請帶我離開這個頁面")])])],1)])],1)},Ko=[],Ho=(a(89195),function(){var t=this,e=t._self._c;t._self._setupProxy;return e("button",{class:(0,Ca.A)({outline:t.outline,disabled:t.disabled,rect:t.rect,small:t.small,auto:t.auto},(0,V.A)({},t.color,!0)),on:{click:t.click}},[t._t("default")],2)}),$o=[],Yo=(0,n.pM)({name:"AppButton",props:{outline:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rect:{type:Boolean,default:!1},color:{type:String,default:"default"},small:{type:Boolean,default:!1},auto:{type:Boolean,default:!1}},setup:function(t,e){var a=function(){t.disabled||e.emit("click")};return{click:a}}}),Zo=Yo,Qo=(0,ne.A)(Zo,Ho,$o,!1,null,"dcff7058",null),Jo=Qo.exports,qo=(0,n.pM)({name:"GettingStartedModal",components:{AppModal:Lo,AppButton:Jo},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup:function(t){return{agree:function(){localStorage.setItem("use-app","true"),t.dismiss&&t.dismiss()}}}}),Xo=qo,tn=(0,ne.A)(Xo,Wo,Ko,!1,null,null,null),en=tn.exports,an=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"tutorial-modal-container"},[e("app-modal",{attrs:{open:t.open,dismiss:t.onDismissClick}},[t.isAdd||t.isUpdate?e("div",{staticClass:"back-button",attrs:{"data-testid":"back-button"},on:{click:t.openHome}},[e("span"),e("span"),e("span")]):t._e(),e("div",{staticClass:"page"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isHome,expression:"isHome"}],attrs:{id:"tutorial-home"}},[e("h2",[t._v("使用說明")]),e("p",[t._v(" 如果系統無法讀取你的位置， 請至手機系統設定開啟位置權限。 ")]),e("div",{staticClass:"outline-button",on:{click:t.openAdd}},[t._v("如何新增一筆"),e("br"),t._v("違章工廠的資料？")]),e("div",{staticClass:"outline-button",on:{click:t.openUpdate}},[t._v("如何在一筆資料裡"),e("br"),t._v("補充更多資訊？")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isAdd,expression:"isAdd"}],attrs:{id:"tutorial-add-factory"}},[e("carousel",{ref:"createCarousel",attrs:{"per-page":1,paginationActiveColor:"#6E8501",paginationColor:"#e3e3e3",paginationPadding:5}},t._l(t.addImages,(function(a,o){return e("slide",{key:a},[e("h2",[t._v("新增違章工廠("+t._s(o+1)+"/7)")]),e("img",{attrs:{src:a}})])})),1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isUpdate,expression:"isUpdate"}],attrs:{id:"tutorial-update-factory"}},[e("carousel",{ref:"updateCarousel",attrs:{"per-page":1,paginationActiveColor:"#6E8501",paginationColor:"#e3e3e3",paginationPadding:5}},t._l(t.updateImages,(function(a,o){return e("slide",{key:a},[e("h2",[t._v("補充工廠資訊("+t._s(o+1)+"/4)")]),e("img",{attrs:{src:a}})])})),1)],1)])])],1)},on=[],nn=(a(33771),a(57742)),rn=(0,n.pM)({name:"TutorialModal",components:{AppModal:Lo,Carousel:nn.Carousel,Slide:nn.Slide},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup:function(t){var e=(0,n.KR)("home"),a=(0,n.EW)((function(){return"home"===e.value})),o=(0,n.EW)((function(){return"add"===e.value})),i=(0,n.EW)((function(){return"update"===e.value})),r=(0,n.KR)(null),s=(0,n.KR)(null),l=function(){e.value="home"},c=function(){r.value.goToPage(0),e.value="add"},u=function(){s.value.goToPage(0),e.value="update"},p=new Array(7).fill(!0).map((function(t,e){return"/images/tutorial/create-".concat(e+1,".jpg")})),d=new Array(4).fill(!0).map((function(t,e){return"/images/tutorial/update-".concat(e+1,".jpg")})),m=function(){l(),t.dismiss()};return{isHome:a,isAdd:o,isUpdate:i,openHome:l,openAdd:c,openUpdate:u,addImages:p,updateImages:d,onDismissClick:m,createCarousel:r,updateCarousel:s}}}),sn=rn,ln=(0,ne.A)(sn,an,on,!1,null,null,null),cn=ln.exports,un=a(92738),pn=a(84242),dn=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(p.A,t._b({attrs:{"max-width":"350"},model:{value:t.safetyModalState,callback:function(e){t.safetyModalState=e},expression:"safetyModalState"}},"v-dialog",t.$attrs,!1),[e("div",{staticClass:"safety-modal"},[e(un.A,{attrs:{"progress-color":"#6E8501",light:"","hide-delimiter-background":"",progress:!1}},[e(c.A,[e(pn.A,{staticClass:"page pa-3"},[e("h1",{staticClass:"mt-3 pb-1 mb-4"},[t._v("安全須知")]),e("p",[t._v(" 請參考以下建議，前往違章工廠拍照蒐證 ")])]),e(pn.A,{staticClass:"page pa-3"},[e("img",{attrs:{src:"/images/safety_notice/1.png",alt:""}}),e("h2",[t._v(" 場勘 ")]),e("p",[t._v(" 假裝路過，檢查有無監視器；尋找適合拍照的隱蔽處 ")])]),e(pn.A,{staticClass:"page pa-3"},[e("img",{attrs:{src:"/images/safety_notice/2.png",alt:""}}),e("h2",[t._v("藏身")]),e("p",[t._v(" 盡量避開監視器、他人視線；盡量在隱蔽處拍照（例如：車上、民宅內、樹叢間、遠方） ")])]),e(pn.A,{staticClass:"page pa-3"},[e("img",{attrs:{src:"/images/safety_notice/3.png",alt:""}}),e("h2",[t._v("避嫌")]),e("p",[t._v("假如地點不夠隱密，請用手機拍照，降低他人戒心")])]),e(pn.A,{staticClass:"page pa-3"},[e("img",{attrs:{src:"/images/safety_notice/4.png",alt:""}}),e("h2",[t._v("速離")]),e("p",[t._v("拍到1張清晰照片即可離去")])]),e(pn.A,{staticClass:"page pa-3"},[e("img",{attrs:{src:"/images/safety_notice/5.png",alt:""}}),e("h2",[t._v("應變")]),e("p",[t._v("假如有人上前問話，請表現得「充滿好奇心」，試著跟對方聊天（例如：好奇水電師傅的施工技術），再伺機離開。")])])],1)],1)],1)])},mn=[],fn=(0,n.pM)({name:"SafetyModal",props:{value:{required:!0,type:Boolean}},setup:function(t,e){var a=(0,n.EW)({get:function(){return t.value},set:function(t){return e.emit("input",t)}});return{safetyModalState:a}}}),vn=fn,yn=(0,ne.A)(vn,dn,mn,!1,null,null,null),gn=yn.exports,hn=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"ios-version-modal-container"},[e("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[e("div",{staticClass:"page"},[e("h3",[t._v("⚠️你的手機無法新增可疑工廠")]),e("p",[t._v(" 很抱歉，你的 iPhone iOS 操作系統無法成功在本網站上傳照片。"),e("br"),t._v(" 請改用電腦新增可疑工廠照片或是至「系統設定」升級 iOS操作系統版本到至少 13.4 以上。瀏覽地圖功能則不受影響。 ")]),e("app-button",{on:{click:t.dismiss}},[t._v("知道了")])],1)])],1)},_n=[],An=(0,n.pM)({name:"IosVersionModal",components:{AppModal:Lo,AppButton:Jo},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}}}),wn=An,xn=(0,ne.A)(wn,hn,_n,!1,null,null,null),bn=xn.exports,Sn=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"api-config-modal-container"},[e("app-modal",{attrs:{open:t.open,dismiss:t.dismiss}},[e("div",{staticClass:"page"},[e("h2",[t._v("API 設定")]),e("div",{staticClass:"form-section"},[e("label",{attrs:{for:"api-url-input"}},[t._v("API 基礎網址")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.apiUrl,expression:"apiUrl"}],staticClass:"url-input",attrs:{id:"api-url-input",type:"text",placeholder:t.defaultUrl,"data-testid":"api-url-input"},domProps:{value:t.apiUrl},on:{input:function(e){e.target.composing||(t.apiUrl=e.target.value)}}}),e("small",{staticClass:"help-text"},[t._v(" 留空將使用預設值："+t._s(t.defaultUrl)+" ")])]),e("div",{staticClass:"button-section"},[e("app-button",{attrs:{"data-testid":"save-button"},on:{click:t.saveConfiguration}},[t._v(" 儲存設定 ")]),e("app-button",{attrs:{outline:!0,"data-testid":"reset-button"},on:{click:t.resetToDefault}},[t._v(" 重置為預設值 ")])],1),e("div",{staticClass:"current-config"},[e("strong",[t._v("目前使用的 API 網址：")]),e("span",{staticClass:"current-url"},[t._v(t._s(t.currentUrl))])])])])],1)},Cn=[],kn=(a(42762),(0,n.pM)({name:"ApiConfigModal",components:{AppModal:Lo,AppButton:Jo},props:{open:{type:Boolean,default:!1},dismiss:{type:Function}},setup:function(t){var e=(0,n.KR)(xe()||""),a=_e(),o=(0,n.EW)((function(){return he.value})),i=function(){var a=e.value.trim();a?Ae(a):we(),t.dismiss&&t.dismiss()},r=function(){e.value="",we(),t.dismiss&&t.dismiss()};return{apiUrl:e,defaultUrl:a,currentUrl:o,saveConfiguration:i,resetToDefault:r}}})),Fn=kn,In=(0,ne.A)(Fn,Sn,Cn,!1,null,"dfcdf030",null),Mn=In.exports,En=(0,n.pM)({name:"App",components:{MapView:da,AppAlert:ha,AboutModal:Ro,ContactModal:No,GettingStartedModal:en,SafetyModal:gn,TutorialModal:cn,IosVersionModal:bn,ApiConfigModal:Mn,CreateFactorySteps:Qa,UpdateFactorySteps:ao,FactoryDetailPage:Co},setup:function(){var t=Ze(),e=(0,b.A)(t,2),a=e[0],o=e[1],i=ta(),r=(0,b.A)(i,2),s=r[0],l=r[1],c=aa(),u=(0,b.A)(c,2),p=u[0],d=u[1];(0,n.Gt)(P,(0,n.KR)(null));var m=(0,n.KR)(!1);return{appState:s,alertState:p,alertActions:d,appActions:l,modalState:a,modalActions:o,drawer:m}}}),Tn=En,On=(0,ne.A)(Tn,w,x,!1,null,null,null),Ln=On.exports,Dn=a(58685),Un=a(33723);(0,Un.k)("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var Pn=a(97073),Rn=a(269),zn=a(60689);n.Ay.use(Rn.A);var Bn=new Rn.A({theme:{themes:{light:{primary:"#697F01",secondary:"#364516",accent:zn.A.green.base}}}});n.Ay.config.productionTip=!1,n.Ay.use(Dn.A),n.Ay.use(Pn.Ay,{config:{id:"UA-154739393-1"},enabled:!0}),new n.Ay({vuetify:Bn,render:function(t){return t(Ln)}}).$mount("#app")}},e={};function a(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,a),i.exports}a.m=t,function(){var t=[];a.O=function(e,o,n,i){if(!o){var r=1/0;for(u=0;u<t.length;u++){o=t[u][0],n=t[u][1],i=t[u][2];for(var s=!0,l=0;l<o.length;l++)(!1&i||r>=i)&&Object.keys(a.O).every((function(t){return a.O[t](o[l])}))?o.splice(l--,1):(s=!1,i<r&&(r=i));if(s){t.splice(u--,1);var c=n();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[o,n,i]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var o in e)a.o(e,o)&&!a.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,o){var n,i,r=o[0],s=o[1],l=o[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(n in s)a.o(s,n)&&(a.m[n]=s[n]);if(l)var u=l(a)}for(e&&e(o);c<r.length;c++)i=r[c],a.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return a.O(u)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=a.O(void 0,[504],(function(){return a(83614)}));o=a.O(o)})();
//# sourceMappingURL=app-legacy.2936f917.js.map